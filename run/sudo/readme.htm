<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<HTML><HEAD><TITLE>Release Notes (Readme.htm) for Windows Support Tools for Microsoft Windows XP Professional</TITLE>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<STYLE>BODY {
	FONT-SIZE: 75%; BACKGROUND: #ffffff; COLOR: #000000; FONT-FAMILY: Verdana, Arial, Sans Serif
}
A:link {
	COLOR: #0000ff; TEXT-DECORATION: underline
}
A:visited {
	COLOR: #0000ff; TEXT-DECORATION: underline
}
A:active {
	CURSOR: hand; COLOR: #ff0000; TEXT-DECORATION: underline
}
A:hover {
	CURSOR: hand; COLOR: #ff0000; TEXT-DECORATION: underline
}
H1 {
	CLEAR: both; FONT-SIZE: 125%; MARGIN-BOTTOM: 0.5em
}
H2 {
	CLEAR: both; MARGIN-TOP: 1.5em; FONT-SIZE: 110%; MARGIN-BOTTOM: 0.5em
}
H3 {
	CLEAR: both; MARGIN-TOP: 1.2em; FONT-SIZE: 100%; MARGIN-BOTTOM: 0.5em
}
P {
	MARGIN-TOP: 0.6em; MARGIN-BOTTOM: 0.6em
}
OL {
	PADDING-LEFT: 0em; MARGIN: 0.5em 2.1em 0px
}
UL {
	PADDING-LEFT: 0em; MARGIN: 0.6em 1.5em 0px; LIST-STYLE-TYPE: disc
}
LI {
	CLEAR: both; MARGIN-BOTTOM: 0.7em
}
P.indent {
	MARGIN-LEFT: 2em
}
P.proclabel {
	CLEAR: both; FONT-WEIGHT: bold; FONT-SIZE: 100%
}
TABLE {
	MARGIN-TOP: 1em; FONT-SIZE: 100%; MARGIN-BOTTOM: 1em
}
TH {
	PADDING-RIGHT: 0.5em; PADDING-LEFT: 0.45em; BACKGROUND: #dddddd; PADDING-BOTTOM: 0.2em; VERTICAL-ALIGN: bottom; PADDING-TOP: 0.2em; TEXT-ALIGN: left
}
TR {
	VERTICAL-ALIGN: top
}
TD {
	PADDING-RIGHT: 0.5em; PADDING-LEFT: 0.45em; BACKGROUND: #eeeeee; PADDING-BOTTOM: 0.2em; VERTICAL-ALIGN: top; PADDING-TOP: 0.2em
}
PRE {
	MARGIN-TOP: 0.5em; MARGIN-BOTTOM: 0.5em
}
CODE {
	FONT-SIZE: 1.1em; FONT-FAMILY: Courier New
}
</STYLE>

<META content="MSHTML 5.50.4522.1800" name=GENERATOR></HEAD>
<BODY>
<H1>Release Notes (Readme.htm) for Windows Support Tools for Microsoft 
Windows&nbsp;XP Professional</H1>
<P>This document contains important information that is not included in the 
online Help for the Microsoft® Windows® Support Tools for Microsoft 
Windows®&nbsp;XP Professional, including 
information not available from other sources about setting up the Windows 
Support Tools for Microsoft Windows&nbsp;XP Professional. Also included are very important corrections and new information 
related to the Windows Support Tools and documentation. </P>
<P>
<H2>Contents</H2>
<P><A href="#about">About the Tools</A></P>
<P><A href="#setup">Setup for Support Tools Software</A></P>
<P class=indent><A href="#toolsnotinst">Tools Documented But
Not Installed In This Release</A></P>
<P class=indent><A href="#tooldifs">Tools 
Not Documented</A></P>
<P class=indent><A href="#general">General 
Setup Instructions</A></P>
<P class=indent><A 
href="#instal">Installing from the Command 
Prompt</A></P>
<P class=indent><A 
href="#install_unattend">Unattended 
Installation</A></P>
<P><A href="#tools_top">Individual Tool 
Release Notes</A></P>
<P class=indent><A 
href="#tools_bitsadmin">Bitsadmin.exe (BITS 
Administration Tool)</A></P>
<P class=indent><A 
href="#tools_httpcfg">Httpcfg.exe (HTTP
Configuration Tool)</A></P>
<P class=indent><A 
href="#tools_ipseccmd">Ipseccmd.exe (IPSec
Configuration Tool)</A></P>
<P class=indent><A 
href="#tools_dumpchk">Dumpchk.exe (Dump 
Check Utility)</A></P>
<P class=indent><A 
href="#tools_rasdiag">Rasdiag.exe (RAS 
Diagnostics Tool)</A></P>
<P class=indent><A 
href="#tools_activate">Activate.exe (Production Activation Tool)</A></P>
<P><A href="#online">Online 
Documents</A></P>
<P><A href="#support">Support 
Policy</A></P>
<HR>

<H2><A name=about>About the Tools</A></H2>
<P>The Windows Support Tools for Microsoft Windows&nbsp;XP Professional are intended for use by Microsoft support 
personnel and experienced users to assist in diagnosing and resolving computer 
problems. For individual tool descriptions, see the Windows Support Tools online 
tool documentation (Suptools.chm).</P>
<HR>

<H2><A name=setup>Setup for Support Tools Software</A></H2>
<P>The Windows Support Tools for Microsoft Windows&nbsp;XP Professional are located in the \Support\Tools folder on the 
Windows&nbsp;XP Professional CD. The \Support\Tools folder contains a Windows Installer file 
(suptools.msi), which installs the Support Tools utilities and tools on your 
computer's hard drive.</P>
<P class=indent><B>Note</B><BR>The Application Compatibility Toolkit does not 
install with the Support Tools.</P>
<P class=indent><B>Important</B><BR>These tools have not been localized: they 
are written and tested in English only. Using these tools with a different 
language version of Microsoft Windows&nbsp;XP Professional might produce unpredictable results.</P>

<H2><A name=toolsnotinst>Tools Documented But Not Installed In This Release</A></H2>
<P>The following tools are documented in the Support Tools help file (Suptools.chm) but are not installed in this release.</P>
<LI>DCDiag.exe
<LI>Repadmin.exe
<BR>

<H2><A name=tooldifs>Tools Not Documented</A></H2>
<P>The following tools install when the <B>Complete</B> checkbox is selected 
during setup. However, these tools are not documented in a separate Help file. 
For most command-line tools, you may type <b>/?</b> (for example, <b>apmstat /?</b>) at the command 
prompt for syntax help. You can also find additional documentation for some tools in the individual
tool release notes within this document. This release note documentation is more recent then the
documentation in the help file.</P>
<LI>Activate.exe 
<LI>Apmstat.exe 
<LI>Bindiff.exe 
<LI>Browstat.exe 
<LI>Cabarc.exe 
<LI>Dsastat.exe 
<LI>Dupfinder.exe 
<LI>Extract.exe 
<LI>IpsecCmd.exe 
<LI>Ksetup.exe 
<LI>Ktpass.exe 
<LI>Ntfrsutil.exe 
<LI>Pviewer.exe 
<LI>Remote.exe 
<LI>Rsdiag.exe 
<LI>Setspn.exe 
<LI>Timezone.exe 
<LI>Tracefmt.exe 
<LI>Tracelog.exe 
<LI>Tracepdb.exe 
<LI>Vfi.exe 
<LI>Whoami.exe 
<LI>Wsremote.exe <BR>
<P>The following tools install when the <B>Complete</B> checkbox is selected 
during setup. However, the Help for these tools contains the Windows&nbsp;2000 version and is not included in Suptools.chm. The help for these tools can be launched from the help menu option of the tools or it can also be launched from the command line by typing the help file name directly.
</P>
<LI>Apimon.exe -- Apimon.hlp
<LI>Dskprobe.exe -- Dskprobe.hlp
<LI>Windiff.exe -- Windiff.hlp<BR>
<P>The following scripts install when the <B>Complete</B> checkbox is selected 
during setup. Help is not included for these scripts. For more information, see the Iadstools.doc and Clonepr.doc files. </P>
<LI>Clonegg.vbs 
<LI>Cloneggu.vbs 
<LI>Clonelg.vbs 
<LI>Clonepr.vbs 
<LI>Search.vbs 
<LI>Sidhist.vbs <BR>
<H2><A name=general>General Setup Instructions</A></H2>
<P>The Windows Support Tools for Microsoft Windows&nbsp;XP Professional can be installed only on a computer running the 
Windows&nbsp;XP Professional operating system. 
They cannot be used to upgrade Microsoft® Windows&nbsp;NT® or Windows®&nbsp;2000 
Support Tools installed on Microsoft Windows&nbsp;NT or Windows&nbsp;2000, 
respectively.</P>
<P class=proclabel>To install the Windows&nbsp;XP Professional Support Tools</P>
<P class=indent><B>Important</B><BR>It is highly recommended that you remove all 
previous versions of Support Tools, including beta versions of the Windows 
Support Tools for Microsoft Windows&nbsp;XP Professional, before running the Support Tools installation program.<BR><BR>If 
the Setup program finds an older version of Support Tools, it opens a dialog box 
with <B>Add/Remove</B> and <B>Remove all</B> (default) options. If you select 
<B>Remove all</B>, Setup automatically uninstalls Support Tools. If you select 
<B>Add/Remove</B>, you can manually uninstall Support Tools.</P>
<OL>
  <LI>Start Windows&nbsp;XP Professional, and 
  then insert the Windows&nbsp;XP Professional CD in your CD-ROM drive. 
  <LI>Follow the instructions that appear on your screen. </LI></OL>
<P class=indent><B>Note</B><BR>In the unlikely event that your computer pauses 
for a few minutes during installation while the Setup window is displaying 
&quot;publishing product information,&quot; please be patient. The Setup program will 
continue shortly and will finish installing the Support Tools.</P>
<P>The Setup program installs Windows Support Tools files onto your hard disk. A 
typical installation requires 4 megabytes (MB) of free space.</P>
<P>As it installs the Support Tools, Setup:</P>
<UL>
  <LI>Creates a <B>Windows Support Tools</B> folder within the <B>Program 
  Files</B> folder on the <B>Start</B> menu, which contains a shortcut to the 
  Windows Support Tools Help. From there you can access the online documentation 
  and launch tools. 
  <LI>Adds the \Program Files\Support Tools directory (or the directory name you 
  choose for installing the tools) to your computer's hard drive. 
  <LI>Appends the \Program Files\Support Tools directory to your computer's PATH 
  statement. This enables you to run an installed Support Tool from a command 
  prompt within any folder on the hard drive without specifying the path to the 
  Support Tools folder. </LI></UL>
<P>Some tools require separate or additional setup besides the steps described 
earlier. For more information about each of these tools and others with 
additional requirements, as well as a complete list of the tools, see the online 
Help file (Suptools.chm).</P>
<P class=indent><B>Note</B><BR>  On the Windows&nbsp;XP 
Professional CD, most tools are compressed 
into cabinet (.cab) files. You cannot run executable files, call other binaries, 
or open documentation directly from .cab files. Before you run a tool that you 
have not installed by using the Support Tools Setup, you must first extract all 
executable files and dependencies for a tool from the .cab file on the CD to 
your hard drive.<BR><BR>Be aware also that for some tools, the Support Tools 
Setup or the tool's own Setup program performs other installation procedures, 
such as making changes in the registry. You might not be able to run these tools 
even if you extract all their files from the .cab; first install them with the 
Support Tools Setup or the tool's own Setup program.</P>
<H3><A name=instal>Installing from the Command Prompt</A></H3>
<P>You can install the Windows Support Tools for Microsoft Windows&nbsp;XP 
Professional from the command prompt. If 
necessary, you can also use the <B>/qb</B> option to install or uninstall in 
silent mode, which requires no further interaction from the user. </P>
<P>The following table lists the command-line options for installing from the 
command prompt.</P>
<TABLE>
  
  <TR>
    <TH>Option</TH>
    <TH>Parameters</TH>
    <TH>Meaning</TH></TR>
  <TR>
    <TD><B>/i</B></TD>
    <TD><I>FullPath</I><b>\suptools.msi</b><BR>[<B>/qb</B>]</TD>
    <TD>Installs or configures.<BR><B>/qb</B> performs unattended installation 
      (optional).</TD></TR>
  <TR>
    <TD><B>/f</B></TD>
    <TD>[ReinstallModes] <I>FullPath</I><b>\suptools.msi</b></TD>
    <TD>Repairs a previous installation.</TD></TR>
  <TR>
    <TD><B>/a</B></TD>
    <TD><I>FullPath</I><b>\suptools.msi</b></TD>
    <TD>Admin Installation. Installs on the network.</TD></TR>
  <TR>
    <TD><B>/x</B></TD>
    <TD><I>FullPath</I><b>\suptools.msi</b></TD>
    <TD>Uninstalls.</TD></TR>
  <TR>
    <TD><B>/l</B></TD>
    <TD><B>[i|w|e|f|a|r|u|c|m|p|+]</B><I>FullPath</I>\<I>LogFile</I></TD>
    <TD>Specifies path to log file. The flags indicate what information to 
      log. 
      <P><B>i</B> &#8211; Status messages.</P>
      <P><B>w</B> &#8211; Nonfatal warnings.</P>
      <P><B>e</B> &#8211; All error messages.</P>
      <P><B>f</B> &#8211; List of replaced files.</P>
      <P><B>a</B> &#8211; Startup of actions.</P>
      <P><B>r</B> &#8211; Action-specific records.</P>
      <P><B>u</B> &#8211; User requests.</P>
      <P><B>c</B> &#8211; Initial UI parameters.</P>
      <P><B>m</B> &#8211; Out of memory.</P>
      <P><B>p</B> &#8211; Terminal properties.</P>
      <P><B>+</B> &#8211; Append to existing file.</P></TD></TR></TABLE>
<P>For example, to install Support Tools in the current directory, insert the 
Windows&nbsp;XP Professional CD in 
your CD-ROM drive and type the following at the command prompt:</P>
<P><B>msiexec /i 
</B><I>CDDriveLetter</I><B>:\support\tools\suptools.msi</B></P>
<P>where: <BR><I>CDDriveLetter</I><B>:</B> is the letter indicating the CD-ROM 
drive (for example, <B>d:</B>). </P>
<H3><A name=install_unattend></A>Unattended Installation</H3>To perform an 
unattended installation of the Windows&nbsp;XP Professional Support Tools from the CD, use the following syntax:<BR>
<P><B>msiexec /i </B><I>CDDriveLetter</I><B>:\support\tools\suptools.msi 
/qb</B></P>
<HR>

<P><A name=tools_top>
<H2>Individual Tool Release Notes</H2></A>
<P>The following section covers release note information for individual 
Windows&nbsp;XP Professional tools. When 
using a tool, make sure to also check the online Help (Suptools.chm) for more 
information.</P>
<UL>
  <LI>
  <H3><A name=tools_bitsadmin>Bitsadmin.exe (BITS Administration 
  Utility)</A></H3>

<p>Allows administrators to manage the Background Intelligent Transfer Service
(BITS), a background file transfer service and queue manager in Microsoft®
Windows&nbsp;Server&#8482;&nbsp;2003 and Microsoft® Windows®&nbsp;XP. Requests to
BITS are submitted by an application and the files can be transferred in a
throttled manner such that the interactive user is not affected by the
bandwidth consumed. Requests are placed in a queue until the files are
transferred, at which time the requesting application is invoked and notified
of the completion.</p>

<h3>Syntax</h3>

<p><span><span><b>bitsadmin</b></span></span> [<b>/<span
class=SpellE>rawreturn</span></b>] [{<b>/wrap | /<span>nowrap</span></b>}]
<i>Parameter</i></p>

<p>Choose a <i>Parameter</i> from the Parameters section:</p>

<h3>Parameters</h3>

<p>{<b>/help</b> | <b>/?</b>} </p>

<p style='margin-left:.5in'><span>Displays command
line usage.</span> </p>

<p><b>/list</b> [<b>/<span>allusers</span></b>] [<b>/verbose</b>]
</p>

<p style='margin-left:.5in'>Lists transfer jobs. The <b>/<span
class=SpellE>allusers</span></b> parameter lists jobs for all users on the
system. The <b>/verbose</b> parameter provides detailed information about jobs.
</p>

<p><b>/monitor</b> [<b>/<span>allusers</span></b>]
[<b>/refresh</b> <i>Seconds</i>] </p>

<p style='margin-left:.5in'><span>Monitors the copy
manager.</span> The <b>/<span>allusers</span></b> parameter
monitors the copy manager for all users on the system. The <b>/refresh</b>
parameter reacquires copy manager data in the specified time interval in
seconds. </p>

<p><b>/reset</b> [<b>/<span>allusers</span></b>] </p>

<p style='margin-left:.5in'><span>Deletes all jobs
in the manager.</span> If run by an administrator with the <b>/<span
class=SpellE>allusers</span></b> parameter, all jobs are deleted. If run by a
normal user, only the jobs owned by the user are deleted. </p>

<p><b>/transfer</b> <i>Name</i> [<b>type</b><span>][</span><b>/priority</b>
<span><i>Priority</i></span>][<b>/<span>aclflags</span></b>
<i>Flags</i>]<i> <span>RemoteURL</span> <span>LocalName</span></i>
</p>

<p style='margin-left:.5in'><span>Transfers one or
more files, which are each specified by <i>Name</i>.</span> The <b>type</b> can
be <b>/Download</b> or <b>/Upload</b>. The default is <b>/Download</b>. The <b>/priority</b>
parameter, by means of the <i>Priority </i><span style=''>variable</span>, sets the priority for the specified file transfer. The
<i>Priority</i> can be <b>FOREGROUND</b>, <b>HIGH</b>, <b>NORMAL</b>,
or <b>LOW</b>. The <b>/<span>aclflags</span></b> parameter, by
means of the <i>Flags </i><span style=''>variable</span>,
sets the address control list (ACL) flags. The <i>Flags</i> <span
style=''>variable </span>can be one or more of the
values in the following table: </p>

<table border=0 cellpadding=0 width="50%"
 style='width:50.0%;margin-left:.5in;'>
 <tr style=''>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p style=''><b>Value</b></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p style=''><b>Description</b></p>
  </td>
 </tr>
 <tr style=''>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p><b>O</b></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p>owner</p>
  </td>
 </tr>
 <tr style=''>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p><b>G</b></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p>group</p>
  </td>
 </tr>
 <tr style=''>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p><b>D</b></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p>DACL</p>
  </td>
 </tr>
 <tr style=''>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p><b>S</b></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p>SACL</p>
  </td>
 </tr>
</table>

<p style='margin-left:.5in'>For example, <b>/<span
class=SpellE>aclflags</span> OGDS</b> copies all ACL parts. <span><i>RemoteURL</i></span>
specifies the file's source location. <span><i>LocalName</i></span>
specifies the file's name on the local target computer. Multiple URL/file pairs
can be specified. </p>

<p><b>/create</b> [<b>type</b>] <span><i>DisplayName</i></span>
</p>

<p style='margin-left:.5in'>Creates a job and assigns <span
class=SpellE><i>DisplayName</i></span> to it. The <b>type</b> can be <b>/Download</b>,
<b>/Upload</b>, or <b>/Upload-Reply.</b> </p>

<p><b>/info</b> <i>Job</i> [<b>/verbose</b>] </p>

<p style='margin-left:.5in'><span>Displays
information about the specified <i>Job</i>.</span> The <b>/verbose</b>
parameter provides detailed information about the job. </p>

<p><b>/<span>addfile</span></b> <i>Job</i> <span
class=SpellE><i>RemoteURL</i></span><i> <span>LocalName</span></i>
</p>

<p style='margin-left:.5in'><span>Adds a file to
the specified <i>Job</i>.</span> <span><i>RemoteURL</i></span>
specifies the file's source location. <span><i>LocalName</i></span>
specifies the file's name on the local target computer. </p>

<p><b>/<span>addfileset</span></b> <i>Job</i> <span
class=SpellE><i>TextFile</i></span> </p>

<p style='margin-left:.5in'><span>Adds multiple
files to the specified <i>Job</i>.</span> Each line of <span><i>TextFile</i></span>
lists a file's remote name and local name, separated by spaces. A line
beginning with '#' is treated as a comment. After the file set is read into
memory, the contents are added to the job. </p>

<p><b>/<span>addfilewithranges</span></b> <i>Job</i>
<span><i>RemoteURL</i></span><i> <span>LocalName</span></i>
<span><i>RangeList</i></span> </p>

<p style='margin-left:.5in'>Similar to <b>/<span>addfile</span></b>,
but BITS reads only selected byte ranges of the URL. <span><i>RangeList</i></span>
is a comma-delimited series of length and offset pairs, for example <code><b><span
style='font-size:10.0pt'>0:100,2000:100,5000:eof</span></b></code> instructs
BITS to read 100 bytes starting at offset zero, 100 bytes starting at offset
2000, and the remainder of the URL starting at offset 5000. </p>

<p><b>/<span>replaceremoteprefix</span></b> <i>Job</i>
<span><i>OldPrefix</i></span> <span><i>NewPrefix</i></span>
</p>

<p style='margin-left:.5in'>The prefixes of all files whose
URLs begin with <span><i>OldPrefix</i></span> are changed to <span
class=SpellE><i>NewPrefix</i></span>. </p>

<p><b>/<span>listfiles</span></b> <i>Job</i> </p>

<p style='margin-left:.5in'><span>Lists the files
in the specified <i>Job</i>.</span> </p>

<p><b>/suspend</b> <i>Job</i> </p>

<p style='margin-left:.5in'><span>Suspends the
specified <i>Job</i>.</span> The job will not be scheduled to run again until
the <b>/resume</b> parameter is run. </p>

<p><b>/resume</b> <i>Job</i> </p>

<p style='margin-left:.5in'>Queues the specified <i>Job</i> to
the list of jobs enabled for transfer. </p>

<p><b>/cancel</b> <i>Job</i> </p>

<p style='margin-left:.5in'><span>Deletes the
specified <i>Job</i>.</span> </p>

<p><b>/complete</b> <i>Job</i> </p>

<p style='margin-left:.5in'>Completes the specified <i>Job</i>
and makes the files available for the destination directory. This is normally
run after the job moves to the transferred state. </p>

<p><b>/<span>gettype</span></b> <i>Job</i> </p>

<p style='margin-left:.5in'><span>Retrieves the job
type of the specified <i>Job</i>.</span> </p>

<p><b>/<span>getaclflags</span></b> <i>Job</i> </p>

<p style='margin-left:.5in'><span>Retrieves the ACL
propagation flags for the specified <i>Job</i>.</span> </p>

<p><b>/<span>setaclflags</span></b> <i>Job</i> <span
class=SpellE><i>ACLFlags</i></span> </p>

<p style='margin-left:.5in'><span>Sets the ACL
propagation flags for the specified <i>Job</i>.</span> <span><i>ACLFlags</i></span>
is a string of one or more of the following flags as shown in the following
table: </p>

<table border=0 cellpadding=0 width="50%"
 style='width:50.0%;margin-left:.5in;'>
 <tr style=''>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p style=''><b>Value</b></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p style=''><b>Description</b></p>
  </td>
 </tr>
 <tr style=''>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p><b>O</b></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p>owner</p>
  </td>
 </tr>
 <tr style=''>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p><b>G</b></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p>group</p>
  </td>
 </tr>
 <tr style=''>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p><b>D</b></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p>DACL</p>
  </td>
 </tr>
 <tr style=''>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p><b>S</b></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p>SACL</p>
  </td>
 </tr>
</table>

<p style='margin-left:.5in'>For example, <b>/<span
class=SpellE>setaclflags</span> OGDS</b> sets all the ACL propagation flags. </p>

<p><b>/<span>getbytestotal</span></b> <i>Job</i> </p>

<p style='margin-left:.5in'><span>Retrieves the
size of the specified <i>Job</i>.</span> </p>

<p><b>/<span>getbytestransferred</span></b> <i>Job</i>
</p>

<p style='margin-left:.5in'>Retrieves the number of bytes
transferred for the specified <i>Job</i>. </p>

<p><b>/<span>getfilestotal</span></b> <i>Job</i> </p>

<p style='margin-left:.5in'><span>Retrieves the
number of files in the specified <i>Job</i>.</span> </p>

<p><b>/<span>getfilestransferred</span></b> <i>Job</i>
</p>

<p style='margin-left:.5in'>Retrieves the number of files
transferred for the specified <i>Job</i>. </p>

<p><b>/<span>getcreationtime</span></b> <i>Job</i>
</p>

<p style='margin-left:.5in'><span>Retrieves the job
creation time for the specified <i>Job</i>.</span> </p>

<p><b>/<span>getmodificationtime</span></b> <i>Job</i>
</p>

<p style='margin-left:.5in'><span>Retrieves the job
modification time for the specified <i>Job</i>.</span> </p>

<p><b>/<span>getcompletiontime</span></b> <i>Job</i>
</p>

<p style='margin-left:.5in'><span>Retrieves the job
completion time for the specified <i>Job</i>.</span> </p>

<p><b>/<span>getstate</span></b> <i>Job</i> </p>

<p style='margin-left:.5in'><span>Retrieves the job
state for the specified <i>Job</i>.</span> </p>

<p><b>/<span>geterror</span></b> <i>Job</i> </p>

<p style='margin-left:.5in'>Retrieves detailed error
information for the specified <i>Job</i>. </p>

<p><b>/<span>getowner</span></b> <i>Job</i> </p>

<p style='margin-left:.5in'><span>Retrieves the job
owner for the specified <i>Job</i>.</span> </p>

<p><b>/<span>getdisplayname</span></b> <i>Job</i> </p>

<p style='margin-left:.5in'><span>Retrieves the
display name for the specified <i>Job</i>.</span> </p>

<p><b>/<span>setdisplayname</span></b> <i>Job</i> <span
class=SpellE><i>DisplayName</i></span> </p>

<p style='margin-left:.5in'><span>Sets the <span
class=SpellE><i>DisplayName</i></span> for the specified <i>Job</i>.</span> </p>

<p><b>/<span>getdescription</span></b> <i>Job</i> </p>

<p style='margin-left:.5in'><span>Retrieves the job
description for the specified <i>Job</i>.</span> </p>

<p><b>/<span>setdescription</span></b> <i>Job</i> <i>Description</i>
</p>

<p style='margin-left:.5in'><span>Sets the
description for the specified <i>Job</i>.</span> </p>

<p><b>/<span>getpriority</span></b> <i>Job</i> </p>

<p style='margin-left:.5in'><span>Retrieves the
priority of the specified <i>Job</i>.</span> </p>

<p><b>/<span>setpriority</span></b> <i>Job</i> <i>Priority</i>
</p>

<p style='margin-left:.5in'><span>Sets the priority
for the specified <i>Job</i>.</span> </p>

<p><b>/<span>getnotifyflags</span></b> <i>Job</i> </p>

<p style='margin-left:.5in'>Retrieves the notify flags for the
specified <i>Job</i>. </p>

<p><b>/<span>setnotifyflags</span></b> <i>Job</i> <span
class=SpellE><i>NotifyFlags</i></span> </p>

<p style='margin-left:.5in'>Sets the notify flags for the
specified <i>Job</i>. </p>

<p><b>/<span>getnotifyinterface</span></b> <i>Job</i>
</p>

<p style='margin-left:.5in'>Determines if notify interface is
registered for the specified <i>Job</i>. </p>

<p><b>/<span>getminretrydelay</span></b> <i>Job</i>
</p>

<p style='margin-left:.5in'><span>Retrieves the
retry delay, in seconds, for the specified <i>Job</i>.</span> </p>

<p><b>/<span>setminretrydelay</span></b> <i>Job</i>
<span><i>RetryDelay</i></span> </p>

<p style='margin-left:.5in'><span>Sets the <span
class=SpellE><i>RetryDelay</i></span>, in seconds, for the specified <i>Job</i>.</span>
</p>

<p><b>/<span>getnoprogresstimeout</span></b> <i>Job</i>
</p>

<p style='margin-left:.5in'><span>Retrieves the no
progress time-out, in seconds, for the specified <i>Job</i>.</span> </p>

<p><b>/<span>setnoprogresstimeout</span></b> <i>Job</i>
<i>Timeout</i> </p>

<p style='margin-left:.5in'><span>Sets the no
progress <i>Timeout</i>, in seconds, for the specified <i>Job</i>.</span> </p>

<p><b>/<span>geterrorcount</span></b> <i>Job</i> </p>

<p style='margin-left:.5in'><span>Retrieves an
error count for the specified <i>Job</i>.</span> </p>

<p><b>/<span>setproxysettings</span></b> <i>Job</i>
<b>usage</b> </p>

<p style='margin-left:.5in'><span>Sets the proxy
usage for the specified <i>Job</i>.</span> The <b>usage</b> choices are shown
in the following table: </p>

<table border=0 cellpadding=0 width="100%"
 style='width:100.0%;margin-left:.5in;'>
 <tr style=''>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p style=''><b>Value</b></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p style=''><b>Description</b></p>
  </td>
 </tr>
 <tr style=''>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p><b>PRECONFIG</b></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p>Use the owner's IE defaults.</p>
  </td>
 </tr>
 <tr style=''>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p><b>AUTODETECT</b></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p>Turn on auto-detection of the proxy.</p>
  </td>
 </tr>
 <tr style=''>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p><b>NO_PROXY</b></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p>Do not use a proxy server.</p>
  </td>
 </tr>
 <tr style=''>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p><b>OVERRIDE</b></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p>Must be followed by an explicit proxy list and a proxy
  bypass list. <b>NULL</b> or <b>&quot;&quot;</b> can be used as an empty proxy
  bypass list. </p>
  </td>
 </tr>
</table>

<p><b>/<span>getproxyusage</span></b> <i>Job</i> </p>

<p style='margin-left:.5in'><span>Retrieves the
proxy usage setting for the specified <i>Job</i>.</span> </p>

<p><b>/<span>getproxylist</span></b> <i>Job</i> </p>

<p style='margin-left:.5in'><span>Retrieves the proxy
list for the specified <i>Job</i>.</span> </p>

<p><b>/<span>getproxybypasslist</span></b> <i>Job</i>
</p>

<p style='margin-left:.5in'><span>Retrieves the
proxy bypass list for the specified <i>Job</i>.</span> </p>

<p><b>/<span>takeownership</span></b> <i>Job</i> </p>

<p style='margin-left:.5in'><span>Takes ownership
of the specified <i>Job</i>.</span> </p>

<p><b>/<span>setnotifycmdline</span></b> <i>Job</i>
<span><i>ProgramName</i></span> <span><i>ProgramParameters</i></span>
</p>

<p style='margin-left:.5in'><span>Sets a program to
execute for notification of the specified <i>Job</i>.</span> <span
class=SpellE><i>ProgramName</i></span> can be <b>NULL</b>. <span><i>ProgramParameters</i></span>
are optional and can be <b>NULL</b>. </p>

<p><b>/<span>getnotifycmdline</span></b> <i>Job</i>
</p>

<p style='margin-left:.5in'><span>Returns the
command line for job notification of the specified <i>Job</i>.</span> </p>

<p><b>/<span>setcredentials</span></b> <i>Job</i> <i>Target</i>
<i>Scheme</i> <i>Username</i> <i>Password</i> </p>

<p style='margin-left:.5in'><span>Adds credentials
to the specified <i>Job</i>.</span> The <i>Target</i> can be either <b>SERVER</b>
or <b>PROXY</b>. The <i>Scheme</i> can be <b>BASIC</b>, <b>DIGEST</b>, <b>NTLM</b>,
<b>NEGOTIATE</b>, or <b>PASSPORT</b>. </p>

<p><b>/<span>removecredentials</span></b> <i>Job</i>
<i>Target</i> <i>Scheme</i> </p>

<p style='margin-left:.5in'><span>Removes
credentials from the specified <i>Job</i>.</span> The <i>Target</i> can be either
<b>SERVER</b> or <b>PROXY</b>. The <i>Scheme</i> can be <b>BASIC</b>, <b>DIGEST</b>,
<b>NTLM</b>, <b>NEGOTIATE</b>, or <b>PASSPORT</b>. </p>

<p><b>/<span>util</span></b> [<b>/<span
class=SpellE>setieproxy</span></b> <i>Account</i> <b>usage</b>] [<b>/<span
class=SpellE>conn</span></b> <span><i>ConnectionName</i></span>] </p>

<p style='margin-left:.5in'>Note: This option requires Administrator account
status.</p>

<p style='margin-left:.5in'>Sets the Internet Explorer proxy
settings for the system <i>Account</i> of the user. If <span><i>ConnectionName</i></span>
is not specified, settings are applied to the default network connection. The <i>Account</i>
can be <b>LOCALSYSTEM</b>, <b>NETWORKSERVICE</b>, or <b>LOCALSERVICE</b>. The <b>usage</b>
choices are shown in the following table: </p>

<p style='margin-left:.5in;text-indent:-.5in;'>&nbsp;</p>

<table border=0 cellpadding=0 width="100%"
 style='width:100.0%;margin-left:.5in;'>
 <tr style=''>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p style=''><b>Value</b></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p style=''><b>Description</b></p>
  </td>
 </tr>
 <tr style=''>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p><b>NO_PROXY</b></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p>Specify direct connection (Do not use a proxy server).</p>
  </td>
 </tr>
 <tr style=''>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p><b>AUTODETECT</b></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p>Turn on auto-detection of the proxy.</p>
  </td>
 </tr>
 <tr style=''>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p><b>MANUAL_PROXY</b></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p>Use an explicit proxy list and bypass list. Must be
  followed by a proxy list and a proxy bypass list (comma-delimited). <b>NULL</b>
  or <b>&quot;&quot;</b> can be used as an empty proxy bypass list.</p>
  </td>
 </tr>
 <tr style=''>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p><b>AUTOSCRIPT</b></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p>Specify a script to be run during proxy auto-discovery. <b>AUTOSCRIPT</b>
  must be followed by a URL indicating the script location. </p>
  </td>
 </tr>
</table>

<p style='margin-left:.5in'>&nbsp;</p>

<p style='margin-left:.5in;text-indent:-.5in;'>Use <span
class=SpellE><i>ConnectionName</i></span> (the name in quotes) to indicate the
network connection to which the new proxy settings should be applied. If you do
not specify <span><i>ConnectionName</i></span>, the default
connection is used (this is usually the LAN connection). Use <b>/<span
class=SpellE>conn</span> /?</b> <span>for</span> a list of possible
connection names. </p>

<p style='margin-left:.5in'>Some examples are:</p>

<p style='margin-left:.75in;text-indent:-.25in;
'><span style='font-family:Symbol;
'><span
style=''>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><span>bitsadmin</span> /<span
class=SpellE>util</span> /<span>setieproxy</span> <span
class=SpellE>localsystem</span> AUTODETECT<b style=''></b></p>

<p style='margin-left:.75in;text-indent:-.25in;
'><span style='font-family:Symbol;
'><span
style=''>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><span>bitsadmin</span> /<span
class=SpellE>util</span> /<span>setieproxy</span> <span
class=SpellE>networkservice</span> NO_PROXY<b style=''></b></p>

<p style='margin-left:.75in;text-indent:-.25in;
'><span style='font-family:Symbol;
'><span
style=''>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><span>bitsadmin</span> /<span
class=SpellE>util</span> /<span>setieproxy</span> <span
class=SpellE>localsystem</span> MANUAL_PROXY proxy1:80 &quot;&quot;<b
style=''></b></p>

<p style='margin-left:.75in;text-indent:-.25in;
'><span style='font-family:Symbol;
'><span
style=''>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><span>bitsadmin</span> /<span
class=SpellE>util</span> /<span>setieproxy</span> <span
class=SpellE>localsystem</span> MANUAL_PROXY pxy1,pxy2,pxy3 NULL<b
style=''></b></p>

<p style='margin-left:.75in;text-indent:-.25in;
'><span style='font-family:Symbol;
'><span
style=''>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><span>bitsadmin</span> /<span
class=SpellE>util</span> /<span>setieproxy</span> <span
class=SpellE>networkservice</span> AUTOSCRIPT http://server/get.as<b
style=''></b></p>

<p style='margin-left:.75in;text-indent:-.25in;
'><span style='font-family:Symbol;
'><span
style=''>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><span>bitsadmin</span> /<span
class=SpellE>util</span> /<span>setieproxy</span> <span
class=SpellE>networkservice</span> NO_PROXY /<span>conn</span>
&quot;XYZ Dialup&quot;<b style=''></b></p>

<p><b>/<span>util</span></b> [<b>/<span
class=SpellE>getieproxy</span></b> <i>Account</i>] [<b>/<span>conn</span></b>
<span><i>ConnectionName</i></span>] </p>

<p style='margin-left:.5in'><span>Retrieves the Internet
Explorer proxy settings for the system <i>Account</i> of the user.</span> If <span
class=SpellE><i>ConnectionName</i></span> is not specified, settings are
applied to the default network connection. The <i>Account</i> can be <b>LOCALSYSTEM</b>,
<b>NETWORKSERVICE</b>, or <b>LOCALSERVICE</b>. Use <span><i>ConnectionName</i></span>
(the name in quotes) to indicate the network connection to which the new proxy
settings should be applied. If you do not specify <span><i>ConnectionName</i></span>,
the default connection is used (this is usually the LAN connection). Use <b>/<span
class=SpellE>conn</span> /?</b> <span>for</span> a list of possible
connection names. </p>

<p><b>/<span>util</span></b> [<b>/version</b>] [<b>/verbose</b>]
</p>

<p style='margin-left:.5in'><span>Displays the
version of BITS currently active on the system.</span> The <b>/verbose</b>
parameter is used for printing additional information useful for
troubleshooting. </p>

<p><b>/<span>util</span></b> [<b>/<span
class=SpellE>repairservice</span></b>] [<b>/force</b>] </p>

<p class=note style='margin-left:.5in'>Note</p>

<p style='
margin-left:.75in;text-indent:-.25in;'><span
style='font-size:10.0pt;font-family:Symbol;
'><span
style=''>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>This option requires Administrator account
status. </p>

<p style='margin-left:.5in'><span>Attempts to
repair a malfunctioning BITS service by inspecting some of the service
configuration settings.</span> If repairing the settings does not clear the
errors in starting the BITS service, use the <b>/force</b> parameter to delete
and re-create the BITS service. </p>

<p class=note style='margin-left:.5in'>Caution</p>

<p style='margin-left:.75in;text-indent:-.25in;
'><span style='font-family:Symbol;
'><span
style=''>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>It is not possible to undo the changes made by
this option. Use this command carefully. </p>

<p>&nbsp;</p>

<p>The following options are valid for <b>/Upload-reply</b> jobs only:</p>

<p><b>/<span>getreplyfilename</span></b> <i>Job</i>
</p>

<p style='margin-left:.5in'>Gets the path of the file
containing the server <span>reply.</span> </p>

<p><b>/<span>setreplyfilename</span></b> <i>Job</i>
<i>Path</i> </p>

<p style='margin-left:.5in'><span>Sets the path of
the file containing the server reply.</span> </p>

<p><b>/<span>getreplyprogress</span></b> <i>Job</i>
</p>

<p style='margin-left:.5in'><span>Returns the size
and progress of the server reply.</span> </p>

<p><b>/<span>getreplydata</span></b> <i>Job</i> </p>

<p style='margin-left:.5in'><span>Retrieves the
server reply data in hexadecimal format.</span> </p>

<p>&nbsp;</p>

<p>The following options can be placed before the command:</p>

<p><b>/<span>rawreturn</span></b> </p>

<p style='margin-left:.5in'><span>Returns data
suitable for parsing.</span> Strips new line characters and formatting from the
output. This parameter can be used with the <b>/create</b> and <b>/get</b>*
parameters. </p>

<p><b>/wrap</b> </p>

<p style='margin-left:.5in'>Wraps output to fit in a command
window. </p>

<p><b>/<span>nowrap</span></b> </p>

<p style='margin-left:.5in'><span>Does not wrap
output to fit in a command window.</span> </p>

<p class=note style='margin-left:.25in'>Note</p>

<ul type=disc>
 <li style=''>Commands that take a job
     parameter will accept either a job name or a job-ID GUID inside braces. <span
    >Bitsadmin</span> reports an error if the name is ambiguous. </li>
</ul>

<h3>Remarks</h3>

<p style='margin-left:.5in;text-indent:-.25in;
'><span style='font-family:Symbol;
'><span
style=''>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><b>Windows Updates</b></p>

<p style='margin-left:.5in'><span>BITS is</span> often erroneously
confused with Windows Update service because Windows Update service uses
Background Intelligent Transfer Service by default.</p>

<p style='margin-left:.5in;text-indent:-.25in;
'><span style='font-family:Symbol;
'><span
style=''>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><b>Network Throttling</b></p>

<p style='margin-left:.5in'>BITS regulates the transfer rate to minimize impact
on user interactivity, such as a job sent to a network printer or Web pages
viewed in Internet Explorer.</p>

<p style='margin-left:.5in;text-indent:-.25in;
'><span style='font-family:Symbol;
'><span
style=''>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><b>Customized APIs</b></p>

<p style='margin-left:.5in'><span>BITS is</span> exposed to
programmers by a set of Application Program Interfaces (APIs). For more
information about using BITS programmatic interfaces, see the <a
href="http://go.microsoft.com/fwlink/?linkid=8124" id=MSUrl>Using Windows XP
Background Intelligent Transfer Service (BITS) with Visual Studio .NET</a> topic
on the MSDN Library Web site (http://go.microsoft.com/fwlink/?linkid=8124).</p>

<h3>Examples</h3>

<h4>Create BITS Job</h4>

<p>To create a job, type: </p>

<p><span><span><code><b><span style='font-size:10.0pt'>bitsadmin</span></b></code></span></span><code><b><span
style='font-size:10.0pt'> /create <span>myjob</span></span></b></code></p>

<p>The following output is displayed:</p>

<pre><code>BITSADMIN version 2.0 <span>[ 5.1.2600.2096</span> ]</code></pre><pre><span
class=GramE><code>BITS administration utility.</code></span><code></code></pre><pre><code>(C) Copyright 2000-2003 Microsoft Corp.</code></pre><pre><code>&nbsp;</code></pre><pre><span
class=GramE><code>Created job {2DC7527D-C7A8-444C-84A9-D772E79D4B37}.</code></span></pre>

<h4 style=''>Get
a Job's Type</h4>

<p style=''>To
find out the type of job for <span><b>myjob</b></span><b>,</b>
type: </p>

<p style=''><span
class=SpellE><span><code><b><span style='font-size:10.0pt'>bitsadmin</span></b></code></span></span><code><b><span
style='font-size:10.0pt'> /<span>gettype</span> <span
class=SpellE>myjob</span></span></b></code></p>

<p style=''>The
following output is displayed:</p>

<pre><code>BITSADMIN version 2.0 <span>[ 5.1.2600.2096</span> ]</code></pre><pre><span
class=GramE><code>BITS administration utility.</code></span><code></code></pre><pre><code>(C) Copyright 2000-2003 Microsoft Corp.</code></pre><pre><code>&nbsp;</code></pre><pre><code>DOWNLOAD</code></pre>

<h4 style=''>Get
a Job's Size</h4>

<p style=''>To
find out the size of a job, type: </p>

<p style=''><span
class=SpellE><span><code><b><span style='font-size:10.0pt'>bitsadmin</span></b></code></span></span><code><b><span
style='font-size:10.0pt'> /<span>getbytestotal</span> <span
class=SpellE>myjob</span></span></b></code></p>

<p style=''>The
following output is displayed:</p>

<pre><code>BITSADMIN version 2.0 <span>[ 5.1.2600.2096</span> ]</code></pre><pre><span
class=GramE><code>BITS administration utility.</code></span><code></code></pre><pre><code>(C) Copyright 2000-2003 Microsoft Corp.</code></pre><pre><code>&nbsp;</code></pre><pre><code>236</code></pre>

<h4 style=''>Get
the Number of Bytes Transferred for a Job</h4>

<p style=''>To
find out how the number of bytes of the job have already been transferred,
type: </p>

<p style=''><span
class=SpellE><span><code><b><span style='font-size:10.0pt'>bitsadmin</span></b></code></span></span><code><b><span
style='font-size:10.0pt'> /<span>getbytestransferred</span> <span
class=SpellE>myjob</span></span></b></code></p>

<p style=''>The
following output is displayed:</p>

<pre><code>BITSADMIN version 2.0 <span>[ 5.1.2600.2096</span> ]</code></pre><pre><span
class=GramE><code>BITS administration utility.</code></span><code></code></pre><pre><code>(C) Copyright 2000-2003 Microsoft Corp.</code></pre><pre><code>&nbsp;</code></pre><pre><code>106</code></pre>

<h4 style=''>Get
the Number of Files in a Job</h4>

<p style=''>To
find out how many files are in a job, type: </p>

<p style=''><span
class=SpellE><span><code><b><span style='font-size:10.0pt'>bitsadmin</span></b></code></span></span><code><b><span
style='font-size:10.0pt'> /<span>getfilestotal</span> <span
class=SpellE>myjob</span></span></b></code></p>

<p style=''>The
following output is displayed:</p>

<pre><code>BITSADMIN version 2.0 <span>[ 5.1.2600.2096</span> ]</code></pre><pre><span
class=GramE><code>BITS administration utility.</code></span><code></code></pre><pre><code>(C) Copyright 2000-2003 Microsoft Corp.</code></pre><pre><code>&nbsp;</code></pre><pre><code>3</code></pre>

<h4 style=''>Get
the Number of Files Transferred for a Job</h4>

<p style=''>To
find out how many files have been transferred by a job, type: </p>

<p style=''><span
class=SpellE><span><code><b><span style='font-size:10.0pt'>bitsadmin</span></b></code></span></span><code><b><span
style='font-size:10.0pt'> /<span>getfilestransferred</span> <span
class=SpellE>myjob</span></span></b></code></p>

<p style=''>The
following output is displayed:</p>

<pre><code>BITSADMIN version 2.0 <span>[ 5.1.2600.2096</span> ]</code></pre><pre><span
class=GramE><code>BITS administration utility.</code></span><code></code></pre><pre><code>(C) Copyright 2000-2003 Microsoft Corp.</code></pre><pre><code>&nbsp;</code></pre><pre><code>1</code></pre>

<h4 style=''>Get
a Job's Creation Time</h4>

<p style=''>To
find out when a job was created, type:<span style=''>  </span></p>

<p style=''><span
class=SpellE><span><code><b><span style='font-size:10.0pt'>bitsadmin</span></b></code></span></span><code><b><span
style='font-size:10.0pt'> /<span>getcreationtime</span> <span
class=SpellE>myjob</span></span></b></code></p>

<p style=''>The
following output is displayed:</p>

<pre><code>BITSADMIN version 2.0 <span>[ 5.1.2600.2096</span> ]</code></pre><pre><span
class=GramE><code>BITS administration utility.</code></span><code></code></pre><pre><code>(C) Copyright 2000-2003 Microsoft Corp.</code></pre><pre><code>&nbsp;</code></pre><pre><code>6/3/2003</code><code> 10:49:02 <span
class=GramE>AM</span></code></pre>

<h4 style=''>Get
a Job's Last Modification Time</h4>

<p style=''>To
find out when a job was last <span>modified,</span> type: </p>

<p style=''><span
class=SpellE><span><code><b><span style='font-size:10.0pt'>bitsadmin</span></b></code></span></span><code><b><span
style='font-size:10.0pt'> /<span>getmodificationtime</span> <span
class=SpellE>myjob</span></span></b></code></p>

<p style=''>The
following output is displayed:</p>

<pre><code>BITSADMIN version 2.0 <span>[ 5.1.2600.2096</span> ]</code></pre><pre><span
class=GramE><code>BITS administration utility.</code></span><code></code></pre><pre><code>(C) Copyright 2000-2003 Microsoft Corp.</code></pre><pre><code>&nbsp;</code></pre><pre><code>6/3/2003</code><code> 10:49:02 <span
class=GramE>AM</span></code></pre>

<h4 style=''>Get
a Job's Completion Time</h4>

<p style=''>To
find out whether and when a job has completed, type: </p>

<p style=''><span
class=SpellE><span><code><b><span style='font-size:10.0pt'>bitsadmin</span></b></code></span></span><code><b><span
style='font-size:10.0pt'> /<span>getcompletiontime</span> <span
class=SpellE>myjob</span></span></b></code></p>

<p style=''>The
following output is displayed:</p>

<pre><code>BITSADMIN version 2.0 <span>[ 5.1.2600.2096</span> ]</code></pre><pre><span
class=GramE><code>BITS administration utility.</code></span><code></code></pre><pre><code>(C) Copyright 2000-2003 Microsoft Corp.</code></pre><pre><code>&nbsp;</code></pre><pre><code>WORKING</code></pre>

<p style=''>The
<span><b>myjob</b></span> job has not yet completed.</p>

<h4 style=''>Get
a Job's State</h4>

<p style=''>To
find out a job's state, type: </p>

<p style=''><span
class=SpellE><span><code><b><span style='font-size:10.0pt'>bitsadmin</span></b></code></span></span><code><b><span
style='font-size:10.0pt'> /<span>getstate</span> <span
class=SpellE>myjob</span></span></b></code></p>

<p style=''>The
following output is displayed:</p>

<pre><code>BITSADMIN version 2.0 <span>[ 5.1.2600.2096</span> ]</code></pre><pre><span
class=GramE><code>BITS administration utility.</code></span><code></code></pre><pre><code>(C) Copyright 2000-2003 Microsoft Corp.</code></pre><pre><code>&nbsp;</code></pre><pre><code>SUSPENDED</code></pre>

<h4 style=''>Get
a Job's Owner</h4>

<p style=''>To
find out which user owns a job, type: </p>

<p style=''><span
class=SpellE><span><code><b><span style='font-size:10.0pt'>bitsadmin</span></b></code></span></span><code><b><span
style='font-size:10.0pt'> /<span>getowner</span> <span
class=SpellE>myjob</span></span></b></code></p>

<p style=''>The
following output is displayed:</p>

<pre><code>BITSADMIN version 2.0 <span>[ 5.1.2600.2096</span> ]</code></pre><pre><span
class=GramE><code>BITS administration utility.</code></span><code></code></pre><pre><code>(C) Copyright 2000-2003 Microsoft Corp.</code></pre><pre><code>&nbsp;</code></pre><pre><code>DOMAINMAIN\<span
class=SpellE>smithj</span></code></pre>

<h4 style=''>Get
a Job's Display Name</h4>

<p style=''>To
find out the display name for a job, type: </p>

<p style=''><span
class=SpellE><span><code><b><span style='font-size:10.0pt'>bitsadmin</span></b></code></span></span><code><b><span
style='font-size:10.0pt'> /<span>getdisplayname</span> <span
class=SpellE>myjob</span></span></b></code></p>

<p style=''>The
following output is displayed:</p>

<pre><code>BITSADMIN version 2.0 <span>[ 5.1.2600.2096</span> ]</code></pre><pre><span
class=GramE><code>BITS administration utility.</code></span><code></code></pre><pre><code>(C) Copyright 2000-2003 Microsoft Corp.</code></pre><pre><code>&nbsp;</code></pre><pre><span
class=SpellE><span><code>myjob</code></span></span></pre>

<p class=note style=''>Note</p>

<p style='
margin-left:.25in;text-indent:-.25in;'><span
style='font-size:10.0pt;font-family:Symbol;
'><span
style=''>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>Using <span>DisplayName</span> as
the argument for the job will work only if there is one job in the queue with
this display name. Otherwise, <span>Bitsadmin</span> will return
an error. If this happens, the GUID must be used. </p>

<h4 style=''>Add
a File to a Specified Job</h4>

<p style=''>To
add a file to a specified job, type:<span style=''>  </span></p>

<p style=''><span
class=SpellE><span><code><b><span style='font-size:10.0pt'>bitsadmin</span></b></code></span></span><code><b><span
style='font-size:10.0pt'> /<span>addfile</span> <span
class=SpellE>myJob</span> http://myserver/myfile.ext c:\myFile.ext</span></b></code></p>

<p style=''>The
following output is displayed:</p>

<pre><code>BITSADMIN version 2.0 <span>[ 5.1.2600.2096</span> ]</code></pre><pre><span
class=GramE><code>BITS administration utility.</code></span><code></code></pre><pre><code>(C) Copyright 2000-2003 Microsoft Corp.</code></pre><pre><code>&nbsp;</code></pre><pre><span
class=GramE><code>Added http://myserver/myfile.ext -&gt; c:\myFile.ext to job.</code></span></pre>

<p class=note style=''>Note</p>

<ul type=disc>
 <li style=''>Instead of using <span
    >myJob</span> as the parameter the previous example, you could
     enter the GUID of the job. You can get the GUID of the job when you do the
     <span>bitsadmin</span> /create. You can also do a <span
    >bitsadmin</span> /list to get the GUID of the job. The GUIDS
     are unique, but the display names are not. </li>
</ul>

<h4 style=''>Resume
a Job</h4>

<p style=''>To
resume a job, type: </p>

<p style=''><span
class=SpellE><span><code><b><span style='font-size:10.0pt'>bitsadmin</span></b></code></span></span><code><b><span
style='font-size:10.0pt'> /resume <span>myJob</span></span></b></code></p>

<p style=''>The
following output is displayed:</p>

<pre><code>BITSADMIN version 2.0 <span>[ 5.1.2600.2096</span> ]</code></pre><pre><span
class=GramE><code>BITS administration utility.</code></span><code></code></pre><pre><code>(C) Copyright 2000-2003 Microsoft Corp.</code></pre><pre><code>&nbsp;</code></pre><pre><code>Job resumed</code></pre>

<h4 style=''>Delete
All Jobs in the Manager</h4>

<p style=''>To
delete all jobs in the manager, type: </p>

<p style=''><span
class=SpellE><span><code><b><span style='font-size:10.0pt'>bitsadmin</span></b></code></span></span><code><b><span
style='font-size:10.0pt'> /reset</span></b></code></p>

<p style=''>The
following output is displayed:</p>

<pre><code>BITSADMIN version 2.0 <span>[ 5.1.2600.2096</span> ]</code></pre><pre><span
class=GramE><code>BITS administration utility.</code></span><code></code></pre><pre><code>(C) Copyright 2000-2003 Microsoft Corp.</code></pre><pre><code> </code></pre><pre><code>{A305C29C-2247-42A6-918E-C575280CE885} canceled.</code></pre><pre><code>{6F2D447C-712E-4674-9FAE-42DBFAD071A8} canceled.</code></pre><pre><code>{0B8068F6-2572-4932-AE12-CD58DA78912E} canceled.</code></pre><pre><code>3 out of 3 jobs canceled.</code></pre>

<h4 style=''>List
Transfer Jobs</h4>

<p style=''>To
list the transfer jobs, type: </p>

<p style=''><span
class=SpellE><span><code><b><span style='font-size:10.0pt'>bitsadmin</span></b></code></span></span><code><b><span
style='font-size:10.0pt'> /list</span></b></code></p>

<p style=''>The
following output is displayed:</p>

<pre><code>BITSADMIN version 2.0 <span>[ 5.1.2600.2096</span> ]</code></pre><pre><span
class=GramE><code>BITS administration utility.</code></span><code></code></pre><pre><code>(C) Copyright 2000-2003 Microsoft Corp.</code></pre><pre><code>&nbsp;</code></pre><pre><code>{A305C29C-2247-42A6-918E-C575280CE885} job1 SUSPENDED 0 / 0 <span
class=SpellE>0</span> / 0</code></pre><pre><code>{6F2D447C-712E-4674-9FAE-42DBFAD071A8} job2 SUSPENDED 0 / 0 <span
class=SpellE>0</span> / 0</code></pre><pre><code>{0B8068F6-2572-4932-AE12-CD58DA78912E} job3 SUSPENDED 0 / 0 <span
class=SpellE>0</span> / 0</code></pre><pre><span><code>Listed 3 job(s).</code></span><code></code></pre>

<h4 style=''>Delete
a Specified Job</h4>

<p style=''>To
delete a specified job, type: </p>

<p style=''><span
class=GramE><code><b><span style='font-size:10.0pt'>bitsadmin</span></b></code></span><code><b><span
style='font-size:10.0pt'> /cancel job1</span></b></code></p>

<p style=''>The
following output is displayed:</p>

<pre><code>BITSADMIN version 2.0 <span>[ 5.1.2600.2096</span> ]</code></pre><pre><span
class=GramE><code>BITS administration utility.</code></span><code></code></pre><pre><code>(C) Copyright 2000-2003 Microsoft Corp.</code></pre><pre><code> </code></pre><pre><code>Job canceled</code></pre>

<h4 style=''>Perform
a Series of Operations Simultaneously</h4>

<p style=''>To
run a series of operations such as /create /<span>addfile</span>
/resume /list /complete, type: </p>

<p style=''><span
class=GramE><code><b><span style='font-size:10.0pt'>bitsadmin</span></b></code></span><code><b><span
style='font-size:10.0pt'> /create /addfile /resume /list /complete</span></b></code></p>

<p style=''>The
following output is displayed:</p>

<pre><code>BITSADMIN version 2.0 <span>[ 5.1.2600.2096</span> ]</code></pre><pre><span
class=GramE><code>BITS administration utility.</code></span><code></code></pre><pre><code>(C) Copyright 2000-2003 Microsoft Corp.</code></pre><pre><code> </code></pre><pre><span
class=GramE><code>Created job {9CFB8267-72BA-4725-A487-8CB1A9390637}.</code></span><code></code></pre><pre><code> </code></pre><pre><span
class=GramE><code>bitsadmin</code></span><code> /addfile job1 http://bitsnet/downloads/50mb.zip c:\temp\50mb.zip</code></pre><pre><code> </code></pre><pre><code>BITSADMIN version 2.0 <span
class=GramE>[ 5.1.2600.2096</span> ]</code></pre><pre><span
class=GramE><code>BITS administration utility.</code></span><code></code></pre><pre><code>(C) Copyright 2000-2003 Microsoft Corp.</code></pre><pre><code> </code></pre><pre><span
class=GramE><code>Added http://bitsnet/downloads/50mb.zip -&gt; c:\temp\50mb.zip to job.</code></span><code></code></pre><pre><code> </code></pre><pre><span
class=GramE><code>bitsadmin</code></span><code> /resume job1</code></pre><pre><code> </code></pre><pre><code>BITSADMIN version 2.0 <span
class=GramE>[ 5.1.2600.2096</span> ]</code></pre><pre><span
class=GramE><code>BITS administration utility.</code></span><code></code></pre><pre><code>(C) Copyright 2000-2003 Microsoft Corp.</code></pre><pre><code> </code></pre><pre><code>Job resumed.</code></pre><pre><code> </code></pre><pre><span
class=GramE><code>bitsadmin</code></span><code> /list</code></pre><pre><code> </code></pre><pre><code>BITSADMIN version 2.0 <span
class=GramE>[ 5.1.2600.2096</span> ]</code></pre><pre><span
class=GramE><code>BITS administration utility.</code></span><code></code></pre><pre><code>(C) Copyright 2000-2003 Microsoft Corp.</code></pre><pre><code> </code></pre><pre><code>{9CFB8267-72BA-4725-A487-8CB1A9390637} job1 TRANSFERRING 0 / 1 2000 / 50189685</code></pre><pre><span
class=GramE><code>Listed 1 job(s).</code></span><code></code></pre><pre><code> </code></pre><pre><span
class=GramE><code>bitsadmin</code></span><code> /list</code></pre><pre><code> </code></pre><pre><code>BITSADMIN version 2.0 <span
class=GramE>[ 5.1.2600.2096</span> ]</code></pre><pre><span
class=GramE><code>BITS administration utility.</code></span><code></code></pre><pre><code>(C) Copyright 2000-2003 Microsoft Corp.</code></pre><pre><code> </code></pre><pre><code>{9CFB8267-72BA-4725-A487-8CB1A9390637} job1 TRANSFERRED 1 / 1 50189685 / 501896</code></pre><pre><span
class=GramE><code>Listed 1 job(s).</code></span><code></code></pre><pre><code> </code></pre><pre><span
class=GramE><code>bitsadmin</code></span><code> /complete</code></pre><pre><code> </code></pre><pre><code>BITSADMIN version 2.0 <span
class=GramE>[ 5.1.2600.2096</span> ]</code></pre><pre><span
class=GramE><code>BITS administration utility.</code></span><code></code></pre><pre><code>(C) Copyright 2000-2003 Microsoft Corp.</code></pre><pre><code> </code></pre><pre><span
class=GramE><code>Invalid number of arguments.</code></span><code></code></pre><pre><code> </code></pre><pre><span
class=GramE><code>bitsadmin</code></span><code> /complete job1</code></pre><pre><code> </code></pre><pre><code>BITSADMIN version 2.0 <span
class=GramE>[ 5.1.2600.2096</span> ]</code></pre><pre><span
class=GramE><code>BITS administration utility.</code></span><code></code></pre><pre><code>(C) Copyright 2000-2003 Microsoft Corp.</code></pre><pre><code> </code></pre><pre><code>Job completed.</code></pre><pre><code>&nbsp;</code></pre><pre><span
class=GramE><code>bitsadmin</code></span><code> /list</code></pre><pre><code> </code></pre><pre><code>BITSADMIN version 2.0 <span
class=GramE>[ 5.1.2600.2096</span> ]</code></pre><pre><span
class=GramE><code>BITS administration utility.</code></span><code></code></pre><pre><code>(C) Copyright 2000-2003 Microsoft Corp.</code></pre><pre><code> </code></pre><pre><span
class=GramE><code>Listed 0 job(s).</code></span><code></code></pre>

<h4 style=''>Run
/list /allusers /verbose</h4>

<p style=''>To
run /list /allusers /verbose, type: </p>

<p style=''><span
class=GramE><code><b><span style='font-size:10.0pt'>bitsadmin</span></b></code></span><code><b><span
style='font-size:10.0pt'> /list /allusers /verbose</span></b></code></p>

<p style=''>The
following output is displayed:</p>

<pre><code>BITSADMIN version 2.0 <span>[ 5.1.2600.2096</span> ]</code></pre><pre><span
class=GramE><code>BITS administration utility.</code></span><code></code></pre><pre><code>(C) Copyright 2000-2003 Microsoft Corp.</code></pre><pre><code>&nbsp;</code></pre><pre><code>&nbsp;</code></pre><pre><code>GUID: {134E18A6-FC4B-46AC-A7E9-B7A7D59C84BE} DISPLAY: test</code></pre><pre><code>&nbsp;</code></pre><pre><code>TYPE: </code><code>DOWNLOAD</code><code> </code><code>STATE</code><code>: SUSPENDED OWNER: DOMAIN1\joe</code></pre><pre><code>&nbsp;</code></pre><pre><code>PRIORITY: </code><code>NORMAL</code><code> FILES: 0 / 1 BYTES: 0 / UNKNOWN</code></pre><pre><code>&nbsp;</code></pre><pre><code>CREATION TIME: </code><code>9/13/2002</code><code> 12:47:10 PM MODIFICATION TIME: </code><code>9/13/2002</code><code> </code><code>12:47:13 PM</code><code></code></pre><pre><code>&nbsp;</code></pre><pre><code>COMPLETION TIME: UNKNOWN</code></pre><pre><code>&nbsp;</code></pre><pre><code>NOTIFY INTERFACE: UNREGISTERED NOTIFICATION FLAGS: 3</code></pre><pre><code>&nbsp;</code></pre><pre><code>RETRY DELAY: 600 NO PROGRESS TIMEOUT: 1209600 ERROR COUNT: 0</code></pre><pre><code>&nbsp;</code></pre><pre><code>PROXY USAGE: PRECONFIG PROXY LIST: NULL PROXY BYPASS LIST: NULL</code></pre><pre><code>&nbsp;</code></pre><pre><code>DESCRIPTION:</code></pre><pre><code>&nbsp;</code></pre><pre><code>JOB FILES:</code></pre><pre><code>&nbsp;</code></pre><pre><code><span style=''>        </span>0 / UNKNOWN WORKING http://www.microsoft.com -&gt; c:\ms</code></pre><pre><code>&nbsp;</code></pre><pre><code>NOTIFICATION COMMAND LINE: none</code></pre><pre><code>&nbsp;</code></pre><pre><code> </code></pre><pre><code>&nbsp;</code></pre><pre><span
class=GramE><code>Listed 1 job(s).</code></span><code></code></pre><pre><code>&nbsp;</code></pre><pre><code> </code></pre><pre><code>&nbsp;</code></pre><pre><code>BITSADMIN version 2.0 <span
class=GramE>[ 5.1.2600.2096</span> ]</code></pre><pre><span
class=GramE><code>BITS administration utility.</code></span><code></code></pre><pre><code>(C) Copyright 2000-2003 Microsoft Corp.</code></pre><pre><code>&nbsp;</code></pre><pre><code> </code></pre><pre><code>&nbsp;</code></pre><pre><code>{134E18A6-FC4B-46AC-A7E9-B7A7D59C84BE} canceled.</code></pre><pre><code>&nbsp;</code></pre><pre><code>1 out of 1 <span
class=GramE>jobs</span> canceled.</code></pre><pre><code>&nbsp;</code></pre>

<p style=''><span
class=reuse><span id=cmdformat><span style='font-size:10.0pt;font-family:
"Courier New"'>XOX</span></span></span> </p>

</div>

  <LI>
  <H3><A name=tools_httpcfg>httpcfg.exe (HTTP Configuration 
  Utility)</A></H3>
  <p>Manages the HTTP application programming interface (API). <b>Httpcfg</b> can
be used to perform many of the tasks associated with Web server administration.
The HTTP API enables applications to communicate over HTTP without using Internet
Information Services (IIS). Applications can register to receive HTTP requests
for particular URLs, receive HTTP requests, and send HTTP responses. The HTTP
API includes SSL support so applications can also exchange data over secure
HTTP connections without depending on IIS. It is also designed to work with I/O
completion ports.</p>

<h3>Syntax</h3>

<p style='text-indent:0in;'><b>httpcfg</b> {<b>set</b>
| <b>query</b> | <b>delete</b>} {<b>ssl</b> | <b>query</b> | <b>iplisten</b>}
[<b>-i</b> <i>Ip:Port</i>] [<b>-h</b> <i>SSL Hash</i>]
[<b>-g</b> <b>&quot;{</b><i>GUID</i><b>}&quot;</b>] [<b>-c</b>
<i>StoreName</i>] [<b>-m</b> <i>CheckMode</i>] [<b>-r</b>
<i>RevocationFreshness</i>] [<b>-x</b> <i>UrlRetrievalTimeout</i>]
[<b>-t</b> <i>SslCtlIdentifier</i>] [<b>-n</b> <i>SslCtlStoreName</i>]
[<b>-f</b> <i>Flags</i>] [<b>-u</b> {<b>http://</b><i>URL</i><b>:</b><i>Port</i><b>/</b>
| <b>https://</b><i>URL</i>:<i>Port</i><b>/</b>}] [<b>-a</b> <i>ACL</i>]</p>

<h3>Parameters</h3>

<p><span style=''>Action</span> commands are <b>set</b>,
<b>query</b>, and <b>delete</b>. These commands are followed by a set of
arguments <b>ssl</b>, <b>urlacl</b>, and <b>iplisten</b>, which are known as <span
style=''>store</span> arguments. Depending on the value
of the <span style=''>action</span> command and the <span
style=''>store</span> argument, different parameters
are then available. For example, the <b>set ssl</b> command can take a
different set of parameters from the <b>query ssl</b> command. </p>

<h4>Action commands</h4>

<p><b>set</b></p>

<p style='margin-left:.5in'>Creates a configuration record that
contains the values specified by the <b>ssl</b>, <b>urlacl</b>, or <b>iplisten</b>
argument. This record is then added to the HTTP API configuration store. The
call fails if a record with the specified values already exists. To change a
given configuration record, you must first <span style=''>delete</span> it, and then recreate it by using <b>set</b> with the
updated value(s).</p>

<p><b>query</b></p>

<p style='margin-left:.5in'>Retrieves one or more HTTP API
configuration records.</p>

<p><b>delete</b></p>

<p style='margin-left:.5in'>Deletes the specified information,
such as IP addresses or SSL certificates, from the HTTP API configuration
store, one record at a time.</p>

<h4>Store arguments</h4>

<p><b>ssl</b></p>

<p style='margin-left:.5in'>Depending on the <span
style=''>action</span> command used, adds (<b>set</b>),
queries, or deletes SSL certificate meta-information. Such meta-information is
maintained by the HTTP API in a metastore, and is used to locate certificates
for certificate exchange during HTTPS sessions.</p>

<p><b>urlacl</b></p>

<p style='margin-left:.5in'>Depending on the <span
style=''>action</span> command used, adds (<b>set</b>),
queries, or deletes namespace reservations. The HTTP API allows administrators
to reserve URI namespaces and protect them with Access Control Lists (ACLs), so
that only specified HTTP API clients can use them.</p>

<p><b>iplisten</b></p>

<p style='margin-left:.5in'>Depending on the <span
style=''>action</span> command used, adds (<b>set</b>),
queries, or deletes Internet Protocol (IP) addresses in the IP Listen List. If
this list is present, the HTTP API listens only to addresses on the list.</p>

<p><span style=''>If you use the following action
command and store argument combination:</span></p>

<p><b>httpcfg</b> <i>set</i> <i>ssl</i></p>

<p><span style=''>you can use the following
parameters:</span></p>

<p><b>-i</b> <i>Ip:Port</i></p>

<p style='margin-left:.5in'>The <b>-i</b> parameter takes a
string that specifies the IP-Address:port combination. This serves as the
record key identifying the SSL certificate being added. When using <b>set ssl</b>,
the <b>-i</b> parameter is required.</p>

<p><b>-h</b> <i>SSL Hash</i></p>

<p style='margin-left:.5in'>The <b>-h</b> parameter takes a
string of hexadecimal digits specifying the Thumbprint hash of the certificate being
added. This is not a required parameter. However, the SSL connection will fail
if the hash is invalid.</p>

<p><b>-g</b> <b>&quot;{</b><i>GUID</i><b>}&quot;</b></p>

<p style='margin-left:.5in'>The <b>-g</b> parameter takes a
string representing a Globally Unique Identifier (GUID) that identifies the
application that added the certificate. In the case of Httpcfg, the GUID must
be generated by the user. The enclosing quotation marks and curly braces are
required; the <b>-g</b> parameter will not work without them. For more information
about generating GUIDs, see <a
href="http://go.microsoft.com/fwlink/?LinkId=9682" target="_new" id=MSUrl>Generating
Interface UUIDs</a> <span class=printonly>(http://go.microsoft.com/fwlink/?LinkId=9682)</span>
on the Microsoft Developer Network (MSDN).</p>

<p><b>-c</b> <i>StoreName</i></p>

<p style='margin-left:.5in'>The <b>-c</b> parameter takes a string
that specifies the name of the store where the certificate being added resides.
If no string is specified, the name &quot;MY&quot; is used by default.</p>

<p><b>-m</b> <i>CheckMode</i></p>

<p style='margin-left:.5in'>The <b>-m</b> parameter takes a
string containing one or more numbers representing flags that determine the
default mode for checking the certificate. The numbers can consist of one or
more of the following flag values: </p>

<p style='
margin-left:1.0in;text-indent:-.25in;'><span
style='font-size:10.0pt;font-family:Symbol;
'><span
style=''>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>1 - Client certificate will not be verified for
revocation.</p>

<p style='
margin-left:1.0in;text-indent:-.25in;'><span
style='font-size:10.0pt;font-family:Symbol;
'><span
style=''>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>2 - Use cached client certificate revocation.</p>

<p style='
margin-left:1.0in;text-indent:-.25in;'><span
style='font-size:10.0pt;font-family:Symbol;
'><span
style=''>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>4 - Enable revocation freshness time.</p>

<p style='
margin-left:1.0in;text-indent:-.25in;'><span
style='font-size:10.0pt;font-family:Symbol;
'><span
style=''>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>65536 - No usage check.</p>

<p><b>-r</b> <i>RevocationFreshness</i></p>

<p style='margin-left:.5in'>The <b>-r</b> parameter takes a
string of numbers that specify the revocation freshness time for the
certificate. Revocation freshness represents the number of seconds after which
to check for an updated certificate revocation list (CRL). If this value is
absent or zero, the new CRL is updated only when the previous one expires.</p>

<p><b>-x</b> <i>UrlRetrievalTimeout</i></p>

<p style='margin-left:.5in'>The <b>-x</b> parameter takes a
string of numbers representing the time-out interval, in milliseconds, for
retrieving a certificate revocation list from the remote URL.</p>

<p><b>-t</b> <i>SslCtlIdentifier</i></p>

<p style='margin-left:.5in'>The <b>-t</b> parameter takes a
string that specifies an SSL control identifier, which restricts the group of
certificate issuers to be trusted. This group must be a subset of the
certificate issuers trusted by the computer <span
style=''> </span>being administered.</p>

<p><b>-n</b> <i>SslCtlStoreName</i></p>

<p style='margin-left:.5in'>The <b>-n</b> parameter takes a
string containing the name of the store in which to look up the control
identifier specified by the <b>-t</b> parameter.</p>

<p><b>-f</b> <i>Flags</i></p>

<p style='margin-left:.5in'>The <b>-f</b> parameter takes a
string containing a number that controls how client certificates are handled.
This number can consist of one or more of the following values: </p>

<p style='
margin-left:1.0in;text-indent:-.25in;'><span
style='font-size:10.0pt;font-family:Symbol;
'><span
style=''>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>1 - Use DS Mapper.</p>

<p style='
margin-left:1.0in;text-indent:-.25in;'><span
style='font-size:10.0pt;font-family:Symbol;
'><span
style=''>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>2 - Negotiate client certificate.</p>

<p style='
margin-left:1.0in;text-indent:-.25in;'><span
style='font-size:10.0pt;font-family:Symbol;
'><span
style=''>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>4 - Do not route to raw ISAPI filters.</p>

<p><span style=''>If you use the following action
command and store argument combination:</span></p>

<p><b>httpcfg</b> <i>query</i> <i>ssl</i></p>

<p><span style=''>you can use the following
parameter:</span></p>

<p><b>-i</b> <i>Ip:Port</i></p>

<p style='margin-left:.5in'>The <b>-i</b> parameter takes a
string that specifies the IP and Address:port combination. This serves as the
record key identifying the SSL certificate being queried. If this parameter is
omitted, then the query returns all records in the SSL store.</p>

<p><span style=''>If you use the following action
command and store argument combination:</span></p>

<p><b>httpcfg</b> <i>delete</i> <i>ssl</i></p>

<p><span style=''>you can use the following
parameter:</span></p>

<p><b>-i</b> <i>Ip:Port</i></p>

<p style='margin-left:.5in'>The <b>-i</b> parameter takes a
string specifying the IP and Address:port combination. This serves as the
record key identifying the SSL certificate to be deleted. When using <b>delete
ssl</b>, the <b>-i</b> parameter is required.</p>

<p><span style=''>If you use the following action
command and store argument combination:</span></p>

<p><b>httpcfg</b> <i>set</i> <i>urlacl</i></p>

<p><span style=''>you can use the following
parameters:</span></p>

<p><b>-u</b> {<b>http://</b><i>URL</i><b>:</b><i>Port</i><b>/</b>
| <b>https://</b><i>URL</i>:<i>Port</i><b>/</b>}</p>

<p style='margin-left:.5in'>The <b>-u</b> parameter takes a
string containing a fully qualified URL that will serve as the record key for
the reservation being made. When using <b>set urlacl</b>, the <b>-u</b>
parameter is required.</p>

<p><b>-a</b> <i>ACL</i></p>

<p style='margin-left:.5in'>The <b>-a</b> parameter takes a
string containing an Access Control List in the form of a Security Descriptor
Definition Language (SDDL) string. When using <b>set urlacl</b>, the <b>-a</b>
parameter is required.</p>

<p><span style=''>If you use the following action
command and store argument combination:</span></p>

<p><b>httpcfg</b> <i>query</i> <i>urlacl</i></p>

<p><span style=''>you can use the following
parameter:</span></p>

<p><b>-u</b> <i>URL</i></p>

<p style='margin-left:.5in'>The <b>-u</b> parameter takes a string
containing a fully qualified URL that identifies the reservation being queried.
If no string is specified, the query returns all reservations in the store.</p>

<p><span style=''>If you use the following action
command and store argument combination:</span></p>

<p><b>httpcfg</b> <i>delete</i> <i>urlacl</i></p>

<p><span style=''>you can use the following
parameter:</span></p>

<p><b>-u</b> <i>URL</i></p>

<p style='margin-left:.5in'>The <b>-u</b> parameter takes a
string containing a fully qualified URL that identifies the reservation to be
deleted. When using <b>delete urlacl</b>, the <b>-u</b> parameter is required.</p>

<p><span style=''>If you use the following action
command and store argument combination:</span></p>

<p><b>httpcfg</b> <i>set</i> <i>iplisten</i></p>

<p><span style=''>you can use the following
parameter:</span></p>

<p><b>-i</b> <i>Ip:Port</i></p>

<p style='margin-left:.5in'>The <b>-i</b> parameter takes a
string specifying the IP address to be added to the IP-Listen List. This can be
either an IPv4 or IPv6 address. When using <b>set iplisten</b>, the <b>-i</b>
parameter is required.</p>

<p><span style=''>If you use the following action
command and store argument combination:</span></p>

<p><b>httpcfg</b> <i>query</i> <i>iplisten</i></p>

<p><span style=''>you can use the following
parameter:</span></p>

<p><b>-i</b> <i>Ip:Port</i></p>

<p style='margin-left:.5in'>The <b>-i</b> parameter takes a
string specifying the exact IP address to be queried. If absent, the query
returns all addresses in the store.</p>

<p><span style=''>If you use the following action
command and store argument combination:</span></p>

<p><b>httpcfg</b> <i>delete</i> <i>iplisten</i></p>

<p><span style=''>you can use the following parameter:</span></p>

<p><b>-i</b> <i>Ip:Port</i></p>

<p style='margin-left:.5in'>The <b>-i</b> parameter takes a
string specifying the IP address to be deleted from the IP-Listen List. This
can be either an IPv4 or IPv6 address. When using <b>delete iplisten</b>, the <b>-i</b>
parameter is required.</p>

<h3>Remarks</h3>

<h4 style='margin-left:.25in;text-indent:-.25in;
'><span style='font-family:Symbol;
font-weight:normal;
'><span style=''>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>The -a Parameter and Security Descriptor
Definition Language</h4>

<p style='margin-left:.25in'>The <b>-a</b> parameter takes a string in the form
of the Security Descriptor Definition Language (SDDL). The SDDL string defines
the format that is used by the '<b>httpcfg</b> <i>set</i> <i>urlacl</i> <b>-a</b>'
command. The SDDL also defines string elements for describing information in
the components of a security descriptor.</p>

<p style='margin-left:.25in'>For more information, see the <a href="http://go.microsoft.com/fwlink/?LinkId=9541"
target="_blank">Security Descriptor Definition Language</a> topic on the
MSDN Library Web site (http://go.microsoft.com/fwlink/?LinkId=9541).</p>

<h4 style='margin-left:.25in;text-indent:-.25in;
'><span style='font-family:Symbol;
font-weight:normal;
'><span style=''>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>Httpcfg.exe and the HTTP API</h4>

<p style='margin-left:.25in'>For more information about how Httpcfg corresponds
to the HTTP API, see <a href="http://go.microsoft.com/fwlink/?LinkId=9550"
target="_blank">Using the HTTP API Configuration Tool</a> on the MSDN Library Web
site (http://go.microsoft.com/fwlink/?LinkId=9550).</p>

<h4 style='margin-left:.25in;text-indent:-.25in;
'><span style='font-family:Symbol;
font-weight:normal;
'><span style=''>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>Httpcfg.exe return codes</h4>

<p style='margin-left:.25in'>The httpcfg.exe commands return a standard WIN32
API error code. A return value of 0 means that the command completed
successfully. For more information about WIN32 API error codes, see the <a href="http://go.microsoft.com/fwlink/?LinkId=9643"
target="_blank">Event Logging</a> topic on the MSDN Library Web site (http://go.microsoft.com/fwlink/?LinkId=9643).
</p>

<h3>Examples</h3>

<h4>Using the httpcfg ssl command</h4>

<p>This group of examples shows how to add, show, and delete a certificate in
the SSL store.</p>

<p style='margin-left:.25in;text-indent:-.25in;
'><span style='font-family:Symbol;
'><span
style=''>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><b>Adding an SSL Certificate to the Store</b></p>

<p style='margin-left:.25in'>In the following example, the user uses the <b
style=''>httpcfg</b><code><b><span style='font-size:
10.0pt'> </span></b></code><b>set ssl</b> command with the <b>-i</b>, <b>-h</b>,
and <b>-g</b> parameters to specify the IP address, Thumbprint hash, and GUID,
respectively, for the certificate being added.</p>

<p style='margin-left:.25in'><code><b><span style='font-size:10.0pt'>httpcfg
set ssl -i 10.0.0.1:80 -h 2c8bfddf59a4a51a2a5b6186c22473108295624d -g
&quot;{2bb50d9c-7f6a-4d6f-873d-5aee7fb43290}&quot;</span></b></code></p>

<p style='margin-left:.25in'>After running the command, Httpcfg displays the
following text on the screen to confirm the command completed without an error
(error code of 0).</p>

<pre style='margin-left:.25in'><code>HttpSetServiceConfiguration completed with 0.</code></pre>

<p style='margin-left:.25in;text-indent:-.25in;
'><span style='font-family:Symbol;
'><span
style=''>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><b>Viewing Certificates in the SSL Store</b></p>

<p style='margin-left:.25in'>In this example, the user first uses the <b
style=''>httpcfg</b><code><b><span style='font-size:
10.0pt'> </span></b></code><b>query ssl</b> command with the <b>-i</b>
parameter, specifying an IP address in order to view the meta-information for a
particular certificate. After viewing the meta-information, the user uses the <b
style=''>httpcfg</b><code><b><span style='font-size:
10.0pt'> </span></b></code><b>query ssl</b> command without the <b>-i</b> parameter,
to view all certificates in the store.</p>

<p style='margin-left:.25in'><code><b><span style='font-size:10.0pt'>httpcfg
query ssl</span></b></code></p>

<pre style='margin-left:.25in'><code>&nbsp;</code></pre><pre
style='margin-left:.25in'><code><span style=''>     </span>IP<span style=''>                      </span>: 10.0.0.13:80</code></pre><pre
style='margin-left:.25in'><code><span style=''>    </span>Hash<span style=''>                    </span>: 2c8bfddf59a4a51a2a5b6186c22473108295624d</code></pre><pre
style='margin-left:.25in'><code><span style=''>    </span>Guid<span style=''>                    </span>: {2bb50d9c-7f6a-4d6f-873d-5aee7fb43290}</code></pre><pre
style='margin-left:.25in'><code><span style=''>  </span><span style=''>  </span>CertStoreName<span style=''>           </span>: (null)</code></pre><pre
style='margin-left:.25in'><code><span style=''>    </span>CertCheckMode<span style=''>           </span>: 0</code></pre><pre
style='margin-left:.25in'><code><span style=''>    </span>RevocationFreshnessTime : 0</code></pre><pre
style='margin-left:.25in'><code><span style=''>    </span>UrlRetrievalTimeout<span style=''>     </span>: 0</code></pre><pre
style='margin-left:.25in'><code><span style=''>    </span>SslCtlIdentifier<span style=''>        </span>: (null)</code></pre><pre
style='margin-left:.25in'><code><span style=''>    </span>SslCtlStoreName<span style=''>         </span>: (null)</code></pre><pre
style='margin-left:.25in'><code><span style=''>    </span>Flags<span style=''>                   </span>: 0</code></pre><pre
style='margin-left:.25in'><code>------------------------------------------------------------------------------</code></pre><pre
style='margin-left:.25in'><code><span style=''>    </span>IP<span style=''>                      </span>: 10.0.0.1:80</code></pre><pre
style='margin-left:.25in'><code><span style=''>    </span>Hash<span style=''>                    </span>: 2c8bfddf59a4a51a2a5b6186c22473108295624d</code></pre><pre
style='margin-left:.25in'><code><span style=''>    </span>Guid<span style=''>                    </span>: {2bb50d9c-7f6a-4d6f-873d-5aee7fb43290}</code></pre><pre
style='margin-left:.25in'><code><span style=''>    </span>CertStoreName<span style=''>           </span>: (null)</code></pre><pre
style='margin-left:.25in'><code><span style=''>    </span>CertCheckMode<span style=''>           </span>: 0</code></pre><pre
style='margin-left:.25in'><code><span style=''>    </span>RevocationFreshnessTime : 0</code></pre><pre
style='margin-left:.25in'><code><span style=''>    </span>UrlRetrievalTimeout<span style=''>     </span>: 0</code></pre><pre
style='margin-left:.25in'><code><span style=''>    </span>SslCtlIdentifier<span style=''>        </span>: (null)</code></pre><pre
style='margin-left:.25in'><code><span style=''>    </span>SslCtlStoreName<span style=''>         </span>: (null)</code></pre><pre
style='margin-left:.25in'><code><span style=''>    </span>Flags<span style=''>                   </span>: 0</code></pre><pre
style='margin-left:.25in'><code>------------------------------------------------------------------------------</code></pre>

<p style='margin-left:.25in;text-indent:-.25in;
'><span style='font-family:Symbol;
'><span
style=''>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><b>Deleting a Certificate from the SSL Store</b></p>

<p style='margin-left:.25in'>In this example, the user types <b
style=''>httpcfg</b><code><b><span style='font-size:
10.0pt'> </span></b></code><b>delete ssl</b> with the required <b>-i</b>
parameter to delete the associated certificate record from the SSL store.</p>

<p style='margin-left:.25in'><code><b><span style='font-size:10.0pt'>httpcfg
delete ssl -i 10.0.0.1:80</span></b></code></p>

<p style='margin-left:.25in'>Httpcgf then displays the following text to the
screen, verifying that the command completed successfully (error code of 0).</p>

<pre style='margin-left:.25in'><code>HttpDeleteServiceConfiguration completed with 0.</code></pre>

<h4>Using the httpcfg urlacl command</h4>

<p>This group of examples shows how to add, remove, and view URL ACL
combinations in the urlacl store.</p>

<p style='margin-left:.25in;text-indent:-.25in;
'><span style='font-family:Symbol;
'><span
style=''>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><b>Adding a URL ACL Combination to the urlacl
Store</b></p>

<p style='margin-left:.25in'><code><b><span style='font-size:10.0pt'>httpcfg
set urlacl -u http://woodgrovebank.com:443/ -a
&quot;O:DAG:DAD:(A;;GRGX;;;DA)(A;;GA;;;BA)&quot;</span></b></code></p>

<pre style='margin-left:.25in'><code>HttpSetServiceConfiguration completed with 0.</code></pre>

<p style='margin-left:.25in;text-indent:-.25in;
'><span style='font-family:Symbol;
'><span
style=''>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><b>Viewing All of the URLs that have been
Assigned an ACL</b></p>

<p style='margin-left:.25in'><code><b><span style='font-size:10.0pt'>httpcfg
query urlacl</span></b></code></p>

<pre style='margin-left:.25in'><code>&nbsp;</code></pre><pre
style='margin-left:.25in'><code><span style=''>    </span>URL : http://woodgrovebank.com:443/</code></pre><pre
style='margin-left:.25in'><code><span style=''>    </span>ACL : O:DAG:DAD:(A;;GXGR;;;DA)(A;;GA;;;BA)</code></pre><pre
style='margin-left:.25in'><code>------------------------------------------------------------------------------</code></pre><pre
style='margin-left:.25in'><code><span style=''>    </span>URL : http://woodgrovebank.com:80/</code></pre><pre
style='margin-left:.25in'><code><span style=''>    </span>ACL : O:DAG:DAD:(A;;CCDC;;;SY)(A;;CCDC;;;DA)(OA;;CCDC;bf967aba-0de6-11d0-a285-00aa003049e2;;AO)(OA;;CCDC;bf967a9c-0d</code></pre><pre
style='margin-left:.25in'><code>e6-11d0-a285-00aa003049e2;;AO)(OA;;CCDC;6da8a4ff-0e52-11d0-a286-00aa003049e2;;AO)(OA;;CCDC;bf967aa8-0de6-11d0-a285-00aa0</code></pre><pre
style='margin-left:.25in'><code>03049e2;;PO)(A;;;;;AU)S:(AU;SAFA;CCDCSWWPSDWDWO;;;WD)</code></pre><pre
style='margin-left:.25in'><code>------------------------------------------------------------------------------</code></pre>

<p style='margin-left:.25in;text-indent:-.25in;
'><span style='font-family:Symbol;
'><span
style=''>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><b>Deleting a URL ACL Combination from the
urlacl Store</b></p>

<p style='margin-left:.25in'><code><b><span style='font-size:10.0pt'>httpcfg
delete urlacl -u http://woodgrovebank.com:80/</span></b></code></p>

<pre style='margin-left:.25in'><code>HttpDeleteServiceConfiguration completed with 0.</code></pre>

<h4>Using the httpcfg iplisten command</h4>

<p>This group of examples show how to add, delete, and list IP address in the
iplisten store.</p>

<p style='margin-left:.25in;text-indent:-.25in;
'><span style='font-family:Symbol;
'><span
style=''>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><b>Adding an IP Address to the iplisten Store</b></p>

<p style='margin-left:.25in'><code><b><span style='font-size:10.0pt'>httpcfg
set iplisten -i 10.0.0.1:80</span></b></code></p>

<pre style='margin-left:.25in'><code>HttpSetServiceConfiguration completed with 0.</code></pre>

<p style='margin-left:.25in;text-indent:-.25in;
'><span style='font-family:Symbol;
'><span
style=''>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><b>Viewing All of the IP Addresses on which the
HTTP API is Listening</b></p>

<p style='margin-left:.25in'><code><b><span style='font-size:10.0pt'>httpcfg
query iplisten</span></b></code></p>

<pre style='margin-left:.25in'><code><span style=''>    </span>IP<span style=''>           </span><span style=''>           </span>: 10.0.0.1:80</code></pre><pre
style='margin-left:.25in'><code>------------------------------------------------------------------------------</code></pre><pre
style='margin-left:.25in'><code><span style=''>    </span>IP<span style=''>                      </span>: 10.0.0.13:80</code></pre><pre
style='margin-left:.25in'><code>------------------------------------------------------------------------------</code></pre>

<p style='margin-left:.25in;text-indent:-.25in;
'><span style='font-family:Symbol;
'><span
style=''>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><b>Shows the Result of Deleting a Record from
the iplisten Store</b></p>

<p style='margin-left:.25in'><code><b><span style='font-size:10.0pt'>httpcfg
delete iplisten -i 10.0.0.1:80</span></b></code></p>

<pre style='margin-left:.25in'><code>HttpDeleteServiceConfiguration completed with 0.</code></pre>

<p><span class=reuse><span id=cmdformat>XOX</span></span>
</p>

</div>

    
  <LI>
  <H3><A name=tools_ipseccmd>ipseccmd.exe (IPSec Configuration Tool)</A></H3>
  <p>Configures Internet Protocol Security (IPSec) policies in a directory
service or in a local or remote registry. Ipseccmd is a command-line
alternative to the IP Security Policies Microsoft Management Console (MMC)
snap-in. Ipseccmd has six modes: dynamic mode, static mode, show mode, set
mode, import mode, and export mode.</p>


<p>You can use Ipseccmd dynamic mode to add anonymous rules to the existing
IPSec policy by adding them to the IPSec security policies database. The rules
added will be present even after the IPSEC Services service is restarted. The
benefit of using dynamic mode is that the rules you add coexist with
domain-based IPSec policy. Dynamic mode is the default mode for Ipseccmd.</p>

<h3>Syntax</h3>

<p style='
margin-left:.5in;text-indent:-.5in;
'><span
style='font-size:10.0pt;font-family:Symbol;
'><span
style=''>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>To add a rule, use the following syntax:</p>

<p style='margin-left:.5in'><b>ipseccmd</b> [<b>\\</b><i>ComputerName</i>]
<b>-f</b> <i>FilterList</i> [<b>-n</b> <i>NegotiationMethodList</i>]
[<b>-t</b> <i>TunnelAddr</i>] [<b>-a</b> <i>AuthMethodList</i>]
[<b>-1s</b> <i>SecurityMethodList</i>] [<b>-1k</b> <i>MMRekeyTime</i>]
[<b>-1e</b> <i>SoftSAExpirationTime</i>] [<b>-soft</b>] [<b>-confirm</b>]
[{<b>-dialup</b> | <b>-lan</b>}]</p>

<p style='
margin-left:.5in;text-indent:-.5in;
'><span
style='font-size:10.0pt;font-family:Symbol;
'><span
style=''>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>To delete all dynamic policies, use the
following syntax:</p>

<p style='margin-left:.5in'><b>ipseccmd -u</b></p>

<h3>Parameters</h3>

<p><b>\\</b><i>ComputerName</i></p>

<p style='margin-left:.5in'>Specifies the computer name of a
remote computer to which you want to add a rule. </p>

<p><b>-f</b> <i>FilterList</i></p>

<p style='margin-left:.5in'>Required for first syntax.
Specifies one or more filter specifications, separated by spaces, for quick
mode security associations (SAs). Each filter specification defines a set of
network traffic affected by this rule.</p>

<p><b>-n</b> <i>NegotiationMethodList</i></p>

<p style='margin-left:.5in'>Specifies one or more security
methods, separated by spaces, for securing traffic defined by the filter list.</p>

<p><b>-t</b> <i>TunnelAddr</i></p>

<p style='margin-left:.5in'>Specifies the tunnel endpoint for
tunnel mode as either an IP address or a DNS domain name.</p>

<p><b>-a</b> <i>AuthMethodList</i></p>

<p style='margin-left:.5in'>Specifies one or more
authentication methods, separated by spaces.</p>

<p><b>-1s</b> <i>SecurityMethodList</i></p>

<p style='margin-left:.5in'>Specifies one or more key exchange
security methods, separated by spaces.</p>

<p><b>-1k</b> <i>MMRekeyTime</i></p>

<p style='margin-left:.5in'>Specifies main mode SA rekey
settings.</p>

<p><b>-1e</b> <i>SoftSAExpirationTime</i></p>

<p style='margin-left:.5in'>Specifies the expiration time for
soft SAs in seconds.</p>

<p><b>-soft</b></p>

<p style='margin-left:.5in'>Enables soft SAs.</p>

<p><b>-confirm</b></p>

<p style='margin-left:.5in'>Specifies that a confirmation
prompt appears before the rule or policy is added.</p>

<p>{<b>-dialup</b> | <b>-lan</b>}</p>

<p style='margin-left:.5in'>Specifies whether the rule applies
only to remote access or dial-up connections or whether the rule applies only
to local area network (LAN) connections.</p>

<p><b>-u</b></p>

<p style='margin-left:.5in'>Required for the second syntax.
Specifies that all dynamic rules are deleted.</p>

<p><b>/?</b></p>

<p style='margin-left:.5in'>Displays help at the command
prompt.</p>

<h3>Remarks</h3>

<p style='
margin-left:.5in;text-indent:-.5in;
'><span
style='font-size:10.0pt;font-family:Symbol;
'><span
style=''>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>Ipseccmd cannot configure rules on computers
running Windows&nbsp;2000. </p>

<p style='
margin-left:.5in;text-indent:-.5in;
'><span
style='font-size:10.0pt;font-family:Symbol;
'><span
style=''>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>If you do not specify the <b>\\</b><i>ComputerName</i>
parameter, the rule is added to the local computer. </p>

<p style='
margin-left:.5in;text-indent:-.5in;
'><span
style='font-size:10.0pt;font-family:Symbol;
'><span
style=''>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>If you use the <b>\\</b><i>ComputerName</i> parameter,
you must use it before all the other parameters, and you must have
administrator permissions on the computer to which you want to add the rule. </p>

<p style='
margin-left:.5in;text-indent:-.5in;
'><span
style='font-size:10.0pt;font-family:Symbol;
'><span
style=''>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>For the <b>-f</b> parameter, a filter
specification is one or more filters that are separated by spaces and is defined
by the following format: </p>

<p style='margin-left:.5in'><i>SourceAddress</i><b>/</b><i>SourceMask</i><b>:</b><i>SourcePort</i><b>=</b><i>DestAddress</i><b>/</b><i>DestMask</i><b>:</b><i>DestPort</i><b>:</b><i>Protocol</i></p>

<p style='
margin-left:1.0in;text-indent:-1.0in;
'><span
style='font-size:10.0pt;font-family:"Courier New";
'><span style=''>o<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><i>SourceMask</i>, <i>SourcePort</i>, <i>DestMask</i>,
and <i>DestPort</i> are optional. If you omit them, the mask of 255.255.255.255
and all ports are used for the filter. </p>

<p style='
margin-left:1.0in;text-indent:-1.0in;
'><span
style='font-size:10.0pt;font-family:"Courier New";
'><span style=''>o<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><i>Protocol</i> is optional. If you omit it, all
protocols are used for the filter. If you specify a protocol, you must specify
the port or precede the protocol with two colons (::). (See the first example
for dynamic mode.) The protocol must be the last item in the filter. You can
use the following protocol symbols: ICMP, UDP, RAW, or TCP. </p>

<p style='
margin-left:1.0in;text-indent:-1.0in;
'><span
style='font-size:10.0pt;font-family:"Courier New";
'><span style=''>o<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>You can create mirrored filters by replacing the
equals sign (=) with a plus sign (+). </p>

<p style='
margin-left:1.0in;text-indent:-1.0in;
'><span
style='font-size:10.0pt;font-family:"Courier New";
'><span style=''>o<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>You can replace <i>SourceAddress</i><b>/</b><i>SourceMask</i>
or <i>DestAddress</i><b>/</b><i>DestMask</i> with the values in the following
table.</p>

<table border=0 cellpadding=0 width="100%"
 style='width:100.0%;margin-left:1.0in'>
 <tr style=''>
  <td width="14%" style='width:14.44%;padding:.75pt .75pt .75pt .75pt'>
  <p><b>Value</b></p>
  </td>
  <td width="84%" style='width:84.54%;padding:.75pt .75pt .75pt .75pt'>
  <p><b>Description</b></p>
  </td>
 </tr>
 <tr style=''>
  <td width="14%" style='width:14.44%;padding:.75pt .75pt .75pt .75pt'>
  <p><b>0</b></p>
  </td>
  <td width="84%" style='width:84.54%;padding:.75pt .75pt .75pt .75pt'>
  <p>My address or addresses</p>
  </td>
 </tr>
 <tr style=''>
  <td width="14%" style='width:14.44%;padding:.75pt .75pt .75pt .75pt'>
  <p><b>*</b></p>
  </td>
  <td width="84%" style='width:84.54%;padding:.75pt .75pt .75pt .75pt'>
  <p>Any address</p>
  </td>
 </tr>
 <tr style=''>
  <td width="14%" style='width:14.44%;padding:.75pt .75pt .75pt .75pt'>
  <p><i>DNSName</i></p>
  </td>
  <td width="84%" style='width:84.54%;padding:.75pt .75pt .75pt .75pt'>
  <p>DNS domain name. If the DNS name resolves to multiple
  addresses, it is ignored. You can specify DNS, WINS, DHCP, or GATEWAY. The
  security policy database (SPD) dynamically replaces these specifications with
  the associated addresses set on the computer.</p>
  </td>
 </tr>
</table>

<p style='
margin-left:1.0in;text-indent:-1.0in;
'><span
style='font-size:10.0pt;font-family:"Courier New";
'><span style=''>o<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>You can enable the default response rule by
specifying the filter specification of <b>default</b>. </p>

<p style='
margin-left:1.0in;text-indent:-1.0in;
'><span
style='font-size:10.0pt;font-family:"Courier New";
'><span style=''>o<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>You can specify a permit filter by surrounding
the filter specification with parentheses. You can specify a blocking filter by
surrounding the filter specification with brackets ([ ]). </p>

<p style='
margin-left:1.0in;text-indent:-1.0in;
'><span
style='font-size:10.0pt;font-family:"Courier New";
'><span style=''>o<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>If you are using Internet address class-based
subnet masks (the subnet masks are defined along octet boundaries), you can use
wildcard notation to specify subnet masks. For example, 10.*.*.* is the same as
10.0.0.0/255.0.0.0 and 10.92.*.* is the same as 10.92.0.0/255.255.0.0. </p>

<p style='margin-left:.5in'><b>Filter examples</b></p>

<p style='margin-left:.5in'>To create mirrored filters to filter TCP traffic
between Computer1 and Computer2, type:</p>

<p style='margin-left:.5in'><b>Computer1+Computer2::TCP</b></p>

<p style='margin-left:.5in'>To create a filter for all TCP traffic from the
subnet 172.31.0.0/255.255.0.0, port 80, to the subnet 10.0.0.0/255.0.0.0, port
80, type: </p>

<p style='margin-left:.5in'><b>172.31.0.0/255.255.0.0:80=10.0.0.0/255.0.0.0:80::TCP</b></p>

<p style='margin-left:.5in'>To create a mirrored filter that permits traffic
between the local IP address and the IP address 10.2.1.1, type: </p>

<p style='margin-left:.5in'><b>(0+10.2.1.1)</b></p>

<p style='
margin-left:.5in;text-indent:-.5in;
'><span
style='font-size:10.0pt;font-family:Symbol;
'><span
style=''>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>For the <b>-n</b> parameter, one or more
negotiation policies are separated by spaces and follow one of the following
forms: </p>

<p style='
margin-left:1.0in;text-indent:-1.0in;
'><span
style='font-size:10.0pt;font-family:"Courier New";
'><span style=''>o<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><b>esp</b>[<i>EncrypAlg</i>,<i>AuthAlg</i>]<i>Rekey</i><b>PFS</b>[<i>Group</i>]
</p>

<p style='
margin-left:1.0in;text-indent:-1.0in;
'><span
style='font-size:10.0pt;font-family:"Courier New";
'><span style=''>o<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><b>ah</b>[<i>HashAlg</i>]<i>Rekey</i><b>PFS</b>[<i>Group</i>]
</p>

<p style='
margin-left:1.0in;text-indent:-1.0in;
'><span
style='font-size:10.0pt;font-family:"Courier New";
'><span style=''>o<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><b>ah</b>[<i>HashAlg</i>]+<b>esp</b>[<i>EncrypAlg</i>,<i>AuthAlg</i>]<i>Rekey</i><b>PFS</b>[<i>Group</i>]
</p>

<p style='margin-left:.75in'>where <i>EncrypAlg</i> can be <b>none</b>, <b>des</b>,
or <b>3des</b>, <i>AuthAlg</i> can be <b>none</b>, <b>md5</b>, or <b>sha</b>,
and <i>HashAlg</i> can be <b>md5</b> or <b>sha</b>.</p>

<p style='
margin-left:1.0in;text-indent:-1.0in;
'><span
style='font-size:10.0pt;font-family:"Courier New";
'><span style=''>o<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>The configuration <b>esp</b>[<b>none,none</b>]
is not supported. </p>

<p style='
margin-left:1.0in;text-indent:-1.0in;
'><span
style='font-size:10.0pt;font-family:"Courier New";
'><span style=''>o<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>The <b>sha</b> parameter refers to the SHA1 hash
algorithm. </p>

<p style='
margin-left:1.0in;text-indent:-1.0in;
'><span
style='font-size:10.0pt;font-family:"Courier New";
'><span style=''>o<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>The <i>Rekey</i> parameter is optional, and it
specifies the number of kilobytes (indicated by placing a <b>K</b> after the
number) or the number of seconds (indicated by placing an <b>S</b> after the
number) that precede a rekeying of the quick mode SA. To specify both rekey
parameters, separate the two numbers with a slash (/). For example, to rekey the
quick mode SA every hour and after every 5 megabytes of data, type: </p>

<p style='margin-left:1.0in'><b>3600S/5000K</b></p>

<p style='
margin-left:1.0in;text-indent:-1.0in;
'><span
style='font-size:10.0pt;font-family:"Courier New";
'><span style=''>o<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>The <b>PFS</b> parameter is optional, and it
enables session key perfect forward secrecy. By default, session key perfect
forward secrecy is disabled. </p>

<p style='
margin-left:1.0in;text-indent:-1.0in;
'><span
style='font-size:10.0pt;font-family:"Courier New";
'><span style=''>o<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>The <i>Group</i> parameter is optional, and it
specifies the Diffie-Hellman group for session key perfect forward secrecy. For
the Low(1) Diffie-Hellman group, specify <b>PFS1</b>. For the Medium(2)
Diffie-Hellman group, specify <b>PFS2</b>. For the High(3) Diffie-Hellman
group, specify <b>PFS3</b>. By default, the group value for session key perfect
forward secrecy is taken from the current main mode settings. </p>

<p style='
margin-left:1.0in;text-indent:-1.0in;
'><span
style='font-size:10.0pt;font-family:"Courier New";
'><span style=''>o<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>If you do not specify negotiation policies, the
default negotiation policies are the following: </p>

<p style='
margin-left:1.5in;text-indent:-1.5in;
'><span
style='font-size:10.0pt;font-family:Wingdings;
'><span
style=''>§<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>esp[3des,sha] </p>

<p style='
margin-left:1.5in;text-indent:-1.5in;
'><span
style='font-size:10.0pt;font-family:Wingdings;
'><span
style=''>§<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>esp[3des,md5] </p>

<p style='
margin-left:1.5in;text-indent:-1.5in;
'><span
style='font-size:10.0pt;font-family:Wingdings;
'><span
style=''>§<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>esp[des,sha] </p>

<p style='
margin-left:1.5in;text-indent:-1.5in;
'><span
style='font-size:10.0pt;font-family:Wingdings;
'><span
style=''>§<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>esp[des,md5] </p>

<p style='
margin-left:.5in;text-indent:-.5in;
'><span
style='font-size:10.0pt;font-family:Symbol;
'><span
style=''>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>If you omit the <b>-t</b> parameter, IPSec
transport mode is used. </p>

<p style='
margin-left:.5in;text-indent:-.5in;
'><span
style='font-size:10.0pt;font-family:Symbol;
'><span
style=''>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>For the <b>-a</b> parameter, one or more
authentication methods are separated by spaces and are in one of the following
forms: </p>

<p style='
margin-left:1.0in;text-indent:-1.0in;
'><span
style='font-size:10.0pt;font-family:"Courier New";
'><span style=''>o<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><b>preshare:&quot;</b><i>PresharedKeyString</i><b>&quot;</b>
</p>

<p style='
margin-left:1.0in;text-indent:-1.0in;
'><span
style='font-size:10.0pt;font-family:"Courier New";
'><span style=''>o<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><b>kerberos</b> </p>

<p style='
margin-left:1.0in;text-indent:-1.0in;
'><span
style='font-size:10.0pt;font-family:"Courier New";
'><span style=''>o<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><b>cert:&quot;</b><i>CAInfo</i><b>&quot;</b> </p>

<p style='margin-left:.5in'>The <i>PresharedKeyString</i> parameter specifies
the string of characters of the preshared key. The <i>CAInfo</i> parameter
specifies the distinguished name of the certificate as displayed in the IP
Security Policies snap-in when the certificate is selected as an authentication
method for a rule. The <i>PresharedKeyString</i> and <i>CAInfo</i> parameters
are case-sensitive. You can abbreviate the authentication method by using the
first letter: <b>p</b>, <b>k</b>, or <b>c</b>. If you omit the <b>-a</b>
parameter, the default authentication method is Kerberos.</p>

<p style='
margin-left:.5in;text-indent:-.5in;
'><span
style='font-size:10.0pt;font-family:Symbol;
'><span
style=''>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>For the <b>-1s</b> parameter, one or more key
exchange security methods are separated by spaces and defined by the following
format:</p>

<p style='margin-left:.5in'><i>EncrypAlg</i><b>-</b><i>HashAlg</i><b>-</b><i>GroupNum</i></p>

<p style='margin-left:.5in'>where <i>EncrypAlg</i> can be <b>des</b> or <b>3des</b>,
<i>HashAlg</i> can be <b>md5</b> or <b>sha</b>, and <i>GroupNum</i> can be <b>1</b>
for the Low(1) Diffie-Hellman group, <b>2</b> for the Medium(2) Diffie-Hellman
group, or <b>3</b> for the High(3) Diffie-Hellman group. If you omit the <b>-1s</b>
parameter, the default key exchange security methods are 3des-sha-2,
3des-md5-2, des-sha-1, and des-md5-1.</p>

<p style='
margin-left:.5in;text-indent:-.5in;
'><span
style='font-size:10.0pt;font-family:Symbol;
'><span
style=''>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>For the <b>-1k</b> parameter, you can specify
the number of quick mode SAs (indicated by placing a <b>Q</b> after the number)
or the number of seconds (indicated by placing an <b>S</b> after the number) to
rekey the main mode SA. To specify both rekey parameters, you must separate the
two numbers with a slash (/). For example, to rekey the main mode SA after
every 10 quick mode SAs and every hour, type:</p>

<p style='margin-left:.5in'><b>10Q/3600S</b></p>

<p style='margin-left:.5in'>If you omit the <b>-1k</b> parameter, the default
values for main mode rekey are an unlimited number of quick mode SAs and 480
minutes.</p>

<p>If you omit the <b>-1e</b> parameter,
the expiration time for soft SAs is 300 seconds. However, soft SAs are disabled
unless you include the <b>-soft</b> parameter, which then sets the value to the
main mode lifetime. </p>

<p style='margin-left:.5in;text-indent:-.5in;

'><span style='font-family:Symbol;
'><span
style=''>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>The <b>-confirm</b> parameter allows
confirmation before setting policy and is available for dynamic mode only.</p>

<p style='margin-left:.5in;text-indent:-.5in;

'><span style='font-family:Symbol;
'><span
style=''>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>The <b>-dialup</b> parameter is optional and
sets policy on addresses of dial-up adapters. The <b>-lan</b> parameter is
optional and sets policy on addresses of LAN adapters. If you specify neither
the <b>-dialup</b> parameter nor the <b>-lan</b> parameter, the rule applies to
all adapters.</p>

<h3 style='margin-left:.5in'>Examples</h3>

<p style='margin-left:.5in'>To create a rule that uses the Authentication
Header (AH) with MD5 hashing for all traffic to and from the local computer,
type:</p>

<p style='margin-left:.5in'><b>ipseccmd -f 0+* -n ah[md5]</b></p>

<p style='margin-left:.5in'>To create a tunnel rule for traffic from 10.2.1.1
and 10.2.1.13 by using the tunnel endpoint 10.2.1.13, with AH tunnel mode by using
the SHA1 hash algorithm, with master key perfect forward secrecy enabled, and
with a confirmation prompt for the rule before it is created, type:</p>

<p style='margin-left:.5in'><b>ipseccmd -f 10.2.1.1=10.2.1.13 -t 10.2.1.13 -n
ah[sha] -1p -c</b></p>

<p style='margin-left:.5in'>To create a rule on the computer named corpsrv1 for
all traffic between the computers named corpsrv1 and corpsrv2, by using the
combination of both AH and Encapsulating Security Payload (ESP), with preshared
key authentication, type:</p>

<p style='margin-left:.5in'><b>ipseccmd \\corpsrv1 -f corpsrv2+corpsrv1 -n
ah[md5]+esp[des,sha] -a p:&quot;corpauth&quot;</b></p>

</div>

<h4>Ipseccmd static mode</h4></p>

<div>

<p style='margin-left:.5in'>Creates named policies and named rules. You can
also use static mode to modify existing policies and rules, provided they were
originally created with Ipseccmd. The syntax for static mode combines the
syntax for dynamic mode with parameters that enable it to work at a policy
level.</p>

<h3 style='margin-left:.5in'>Syntax</h3>

<p style='margin-left:.5in'><b>ipseccmd</b> <i>DynamicModeParameters</i>
<b>-w</b> <i>Location</i> <b>-p</b> <i>PolicyName</i>[<b>:</b><i>PollInterval</i>]
<b>-r</b> <i>RuleName</i> [{<b>-x</b> | <b>-y</b>}] [<b>-o</b>]</p>

<h3 style='margin-left:.5in'>Parameters</h3>

<p style='margin-left:.5in'><i>DynamicModeParameters</i></p>

<p style='margin-left:.5in'>Required. Specifies a set of
dynamic mode parameters for an IPSec rule as described earlier.</p>

<p style='margin-left:.5in'><b>-w</b> <i>Location</i></p>

<p style='margin-left:.5in'>Required. Specifies that the
policies and rules are written to the local registry, a remote computer's
registry, or to persistent storage.</p>

<p style='margin-left:.5in'><b>-p</b> <i>PolicyName</i>[<b>:</b><i>PollInterval</i>]</p>

<p style='margin-left:.5in'>Required. Specifies the name of the
policy and how often, in minutes, the policy is checked for changes. If <i>PolicyName</i>
contains any spaces, use quotation marks around the text (that is, <b>&quot;</b><i>Policy&nbsp;Name</i><b>&quot;</b>).
</p>

<p style='margin-left:.5in'><b>-r</b> <i>RuleName</i></p>

<p style='margin-left:.5in'>Required. Specifies the name of the
rule. If <i>RuleName </i>contains any spaces, use quotation marks around the
text (that is, <b>&quot;</b><i>Rule&nbsp;Name</i><b>&quot;</b>).</p>

<p style='margin-left:.5in'>[{<b>-x</b> | <b>-y</b>}]</p>

<p style='margin-left:.5in'>Optional parameters. The <b>-x</b>
parameter requires the <b>-p</b> option and specifies that the local registry
policy is assigned. The <b>-y</b> parameter specifies that the local registry
policy is unassigned.</p>

<p style='margin-left:.5in'><b>-o</b></p>

<p style='margin-left:.5in'>Specifies that the rule or policy
should be deleted.</p>

<p style='margin-left:.5in'><b>/?</b></p>

<p style='margin-left:.5in'>Displays help at the command
prompt.</p>

<h3 style='margin-left:.5in'>Remarks</h3>

<p style='
margin-left:1.0in;text-indent:-1.0in;
'><span
style='font-size:10.0pt;font-family:"Courier New";
'><span style=''>o<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>For the <b>-w</b> parameter, the <i>Location</i>
is either <b>reg</b> to specify the registry of the local computer or a remote
computer, or <b>pers</b> to specify persistent storage. With <b>reg</b>, if you
specified <b>\\</b><i>ComputerName</i>, the policy is written to the remote
computer's registry. </p>

<p style='
margin-left:1.0in;text-indent:-1.0in;
'><span
style='font-size:10.0pt;font-family:"Courier New";
'><span style=''>o<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>For the <b>-p</b> parameter, if a policy with
this name already exists, the rule you specify is added to the policy.
Otherwise, a policy is created with the name you specify. The <i>PollInterval</i>
parameter is optional and specifies when IPSec should check for policy updates,
for example, when there are changes to assigned DNS servers. If you specify an
integer for <i>PollInterval</i>, the polling interval for the policy is set to
that number of minutes. If you do not specify <i>PollInterval</i>, the polling
interval defaults to 480 minutes. </p>

<p style='
margin-left:1.0in;text-indent:-1.0in;
'><span
style='font-size:10.0pt;font-family:"Courier New";
'><span style=''>o<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>For the <b>-r</b> parameter, if a rule with that
name already exists, the rule is modified to reflect the parameters you specify
in the command. For example, if you include the <b>-f</b> parameter for an
existing rule, only the filters of that rule are replaced. If no rule exists
with the name you specify, a rule with that name is created. </p>

<p style='
margin-left:1.0in;text-indent:-1.0in;
'><span
style='font-size:10.0pt;font-family:"Courier New";
'><span style=''>o<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>For the <b>-o</b> parameter, all aspects of the
specified policy are deleted. Do not use this parameter if you have other
policies that point to the objects in the policy you want to delete. </p>

<p style='margin-left:1.0in;text-indent:-1.0in;

'><span style='font-size:10.0pt;
font-family:"Courier New";'><span style=''>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>Static mode usage differs from dynamic mode
usage in one respect. When you use dynamic mode, you indicate permit and
blocking filters in <i>FilterList</i>, which you identify by using the <b>-f</b>
parameter. When you use static mode, you indicate permit and blocking filters
in <i>NegotiationMethodList</i>, which you identify by using the <b>-n</b>
parameter. In addition to the parameters described for <i>NegotiationMethodList</i>
under dynamic mode, you can also use the <b>block</b>, <b>pass</b>, or <b>inpass</b>
parameters in static mode. The following table lists these parameters and descriptions
of their behavior.</p>

<table border=0 cellpadding=0 width="100%"
 style='width:100.0%;margin-left:1.0in'>
 <tr style=''>
  <td width="14%" style='width:14.44%;padding:.75pt .75pt .75pt .75pt'>
  <p><b>Parameter</b></p>
  </td>
  <td width="84%" style='width:84.54%;padding:.75pt .75pt .75pt .75pt'>
  <p><b>Description</b></p>
  </td>
 </tr>
 <tr style=''>
  <td width="14%" style='width:14.44%;padding:.75pt .75pt .75pt .75pt'>
  <p><b>block</b></p>
  </td>
  <td width="84%" style='width:84.54%;padding:.75pt .75pt .75pt .75pt'>
  <p>The rest of the policies in <i>NegotiationMethodList</i>
  are ignored, and all of the filters become blocking filters.</p>
  </td>
 </tr>
 <tr style=''>
  <td width="14%" style='width:14.44%;padding:.75pt .75pt .75pt .75pt'>
  <p><b>pass</b></p>
  </td>
  <td width="84%" style='width:84.54%;padding:.75pt .75pt .75pt .75pt'>
  <p>The rest of the policies in <i>NegotiationMethodList</i> are
  ignored, and all of the filters become permit filters.</p>
  </td>
 </tr>
 <tr style=''>
  <td width="14%" style='width:14.44%;padding:.75pt .75pt .75pt .75pt'>
  <p><b>inpass</b></p>
  </td>
  <td width="84%" style='width:84.54%;padding:.75pt .75pt .75pt .75pt'>
  <p>Inbound filters allow initial communication to be
  unsecured, but responses are secured using IPSec.</p>
  </td>
 </tr>
</table>

<h3 style='margin-left:.5in'>Examples</h3>

<p style='margin-left:.5in'>To create a policy named Default Domain Policy with
a 30-minute polling interval in which policy changes are written to persistent
storage, with a rule named Secured Servers for traffic between the local
computer and computers named SecuredServer1 and SecuredServer2, and by using
Kerberos and preshared key authentication methods, type:</p>

<p style='margin-left:.5in'><b>ipseccmd -f 0+SecuredServer1 0+SecuredServer2 -a
k p:&quot;corpauth&quot; -w pers -p &quot;Default Domain Policy&quot;:30 -r
&quot;Secured Servers&quot; </b></p>

<p style='margin-left:.5in'>To create and assign a local policy named Me to
Anyone, with a rule named Secure My Traffic, by using a mirrored filter for any
traffic to the local computer, and by using a preshared key as the
authentication method, type:</p>

<p style='margin-left:.5in'><b>ipseccmd -f 0+* -a p:&quot;localauth&quot; -w
reg -p &quot;Me to Anyone&quot; -r &quot;Secure My Traffic&quot; -x</b></p>

</div>

<h4>Ipseccmd show mode</h4></p>

<div>

<p style='margin-left:.5in'>Displays data from the IPSec policies database.</p>

<h3 style='margin-left:.5in'>Syntax</h3>

<p style='margin-left:.5in'><b>ipseccmd</b> [<b>\\</b><i>ComputerName</i>]
<b>show</b> {{[<b>gpo</b>] | [<b>filters</b>]<wbr> | [<b>policies</b>]
| [<b>auth</b>] | [<b>stats</b>] <wbr>| [<b>sas</b>]} | <b>all</b>}</p>

<h3 style='margin-left:.5in'>Parameters</h3>

<p style='margin-left:.5in'><b>\\</b><i>ComputerName</i></p>

<p style='margin-left:1.0in'>Specifies by name the remote
computer for which you want to display data. </p>

<p style='margin-left:.5in'><b>show</b></p>

<p style='margin-left:1.0in'>Required. Specifies that Ipseccmd must
run in show mode.</p>

<p style='margin-left:.5in'><b>gpo</b></p>

<p style='margin-left:1.0in'>Displays static policy assignment
information. </p>

<p style='margin-left:.5in'><b>filters</b></p>

<p style='margin-left:1.0in'>Displays main mode and quick mode
filters.</p>

<p style='margin-left:.5in'><b>policies</b></p>

<p style='margin-left:1.0in'>Displays main mode and quick mode
policies.</p>

<p style='margin-left:.5in'><b>auth</b></p>

<p style='margin-left:1.0in'>Displays main mode authentication
methods.</p>

<p style='margin-left:.5in'><b>stats</b></p>

<p style='margin-left:1.0in'>Displays statistics about Internet
Key Exchange (IKE) and IPSec.</p>

<p style='margin-left:.5in'><b>sas</b></p>

<p style='margin-left:1.0in'>Displays main mode and quick mode
security associations (SAs).</p>

<p style='margin-left:.5in'><b>all</b></p>

<p style='margin-left:1.0in'>Displays data provided by all of
the parameters except <b style=''>/?</b>.</p>

<p style='margin-left:.5in'><b>/?</b></p>

<p style='margin-left:1.0in'>Displays help at the command
prompt.</p>

<h3 style='margin-left:.5in'>Remarks</h3>

<p style='
margin-left:1.0in;text-indent:-1.0in;
'><span
style='font-size:10.0pt;font-family:"Courier New";
'><span style=''>o<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>Ipseccmd does not display IPSec data for
computers running Windows&nbsp;2000. </p>

<p style='
margin-left:1.0in;text-indent:-1.0in;
'><span
style='font-size:10.0pt;font-family:"Courier New";
'><span style=''>o<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>If you do not use the <b>\\</b><i>ComputerName</i>
parameter, information about the local computer is displayed. </p>

<p style='
margin-left:1.0in;text-indent:-1.0in;
'><span
style='font-size:10.0pt;font-family:"Courier New";
'><span style=''>o<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>If you use the <b>\\</b><i>ComputerName</i>
parameter, you must use it before all the other parameters, and you must have
administrator permissions on the computer for which you want to display
information. </p>

<h3 style='margin-left:.5in'>Examples</h3>

<p style='margin-left:.5in'>To display the main mode and quick mode filters and
policies for the local computer, type:</p>

<p style='margin-left:.5in'><b>ipseccmd show filters policies</b></p>

<p style='margin-left:.5in'>To display all IPSec information for the remote
computer Server1, type the following command:</p>

<p style='margin-left:.5in'><b>ipseccmd \\Server1 show all</b></p>

</div>
<h4>Ipseccmd set mode</h4>

<div>

<p style='margin-left:.5in'>Sets configuration parameters for IPSec.</p>

<h3 style='margin-left:.5in'>Syntax</h3>

<p style='margin-left:.5in'><b>ipseccmd</b> [<b>\\</b><i>ComputerName</i>]
<b>set</b> [{<b>logike</b> | <b>dontlogike</b>}]</p>

<h3 style='margin-left:.5in'>Parameters</h3>

<p style='margin-left:.5in'><b>\\</b><i>ComputerName</i></p>

<p style='margin-left:1.0in'>Specifies by name the remote
computer for which you want to have configuration parameters set. </p>

<p style='margin-left:.5in'><b>set</b></p>

<p style='margin-left:1.0in'>Required. Specifies that Ipseccmd must
run in set mode.</p>

<p style='margin-left:.5in'><b>logike</b></p>

<p style='margin-left:1.0in'>Turns on Internet Key Exchange
(IKE) logging.</p>

<p style='margin-left:.5in'><b>dontlogike</b></p>

<p style='margin-left:1.0in'>Turns off IKE logging.</p>

<p style='margin-left:.5in'><b>/?</b> </p>

<p style='margin-left:1.0in'>Displays help at the command
prompt. </p>

<h3 style='margin-left:.5in'>Examples</h3>

<p style='margin-left:.5in'>To turn off IKE logging on the local computer,
type:</p>

<p style='margin-left:.5in'><b>ipseccmd set dontlogike</b></p>

<p style='margin-left:.5in'>To turn on IKE logging on the computer named
server2, type:</p>

<p style='margin-left:.5in'><b>ipseccmd \\server2 set logike</b></p>

<h4>Ipseccmd import/export mode</h4>

<div>

<p style='margin-left:.5in'>Imports or exports policy data files (files
containing an .ipsec extension).</p>

<h3 style='margin-left:.5in'>Syntax</h3>

<p style='margin-left:.5in'><b>ipseccmd</b> [<b>\\</b><i>ComputerName</i>]
[{<b>import</b> | <b>export</b>}] <i>Location</i> <i>FileName</i></p>

<h3 style='margin-left:.5in'>Parameters</h3>

<p style='margin-left:.5in'><b>\\</b><i>ComputerName</i></p>

<p style='margin-left:1.0in'>Specifies by name the remote
computer from which you want to import policy data, or to which you want to
export policy data. </p>

<p style='margin-left:.5in'>{<b>import</b> | <b>export</b>}</p>

<p style='margin-left:1.0in'>Required. Specifies that Ipseccmd must
run in import or export mode.</p>

<p style='margin-left:.5in'><i>Location</i></p>

<p style='margin-left:1.0in'>Required. Specifies that the
policy data is read from or written to the local registry, a remote computer's
registry, or to persistent storage.</p>

<p style='margin-left:.5in'><i>FileName</i></p>

<p style='margin-left:1.0in'>Required. Specifies the name of
the file to import from or export to. If an export file name does not specify
the .ipsec extension, the extension is automatically appended.</p>

<p style='margin-left:.5in'><b>/?</b> </p>

<p style='margin-left:1.0in'>Displays help at the command
prompt. </p>

<h3 style='margin-left:.5in'>Remarks</h3>

<p style='
margin-left:1.0in;text-indent:-1.0in;
'><span
style='font-size:10.0pt;font-family:"Courier New";
'><span style=''>o<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>The <i>Location</i> is either <b>reg</b> to
specify the registry of the local computer or a remote computer, or <b>pers</b>
to specify persistent storage. If you use <b>reg</b> and you specify <b>\\</b><i>ComputerName</i>,
the policy is read from or written to the remote computer's registry. </p>

<h3 style='margin-left:.5in'>Examples</h3>

<p style='margin-left:.5in'>To export policy data to persistent storage, type:</p>

<p style='margin-left:.5in'><b>ipseccmd export pers persistent.ipsec</b></p>

<p style='margin-left:.5in'>To import policy data from the file named
server1.ipsec on the computer named server1, type:</p>

<p style='margin-left:.5in'><b>ipseccmd \\server1 import reg server1.ipsec</b></p>



</div>

  
  <LI>
  <H3><A name=tools_dumpchk>Dumpchk.exe (Dump Check Tool)</A></H3>
  <P>Enables administrators to verify that a crash dump (user mode:user.dmp or 
  kernel mode:memory.dmp) has been created correctly. It also provides options 
  for performing some dump file analysis without using a debugger.</P>
  <DT><B>/?</B>
  <DD>Type at the command prompt to display help. 
  <P class=indent><B>Note</B><BR>This tool is not documented in the Help for 
  Support Tools (Suptools.chm).</P></DD>
  <LI>
  <H3><A name=tools_rasdiag>Rasdiag.exe (RAS Diagnostics Tool)</A></H3>
  <P>Collects diagnostic information about remote services and places that 
  information in a file. Administrators can use this tool to work with Product 
  Support Services to troubleshoot remote connection issues by taking a snapshot 
  of the configuration data and capturing an attempted remote connection. 
  <DT><B>/?</B> 
  <DD>Type at the command prompt to display help. 
  <P class=indent><B>Note</B><BR>This tool is not documented in the Help for 
  Support Tools (Suptools.chm).</P></DD>
  <LI>
  <H3><A name=tools_activate>Activate.exe (Product Activation Tool)</A></H3>
  <P>See Activate.doc for more information on the automatic product activation 
  tool. 
    <P class=indent><B>Note</B><BR>This tool is not documented in the Help for 
  Support Tools (Suptools.chm).</P></DD>
  <DT></DT></LI></UL>
<HR>

<H2><A name=online>Online Documents</A></H2>
<P>The following table describes major online documents available with the 
Windows Support Tools for Microsoft Windows&nbsp;XP Professional</P>
<TABLE>
  
  <TR>
    <TH>Document</TH>
    <TH>Description</TH>
  <TR>
    <TD>Suptools.chm</TD>
    <TD>Documentation for Windows Support Tools for Microsoft Windows&nbsp;XP 
      Professional, describing the required 
      files, syntax, and other usage issues, along with examples for using these 
      tools.</TD></TR></TABLE>
<HR>

<H2><A name=support>Support Policy</A></H2>
<P>The SOFTWARE supplied in the Program Files\Support Tools directory is not 
supported under any Microsoft standard support program or service. You can, 
however, report issues and bugs by sending e-mail to <A 
href="mailto:stinput@microsoft.com">stinput@microsoft.com</A>. Microsoft will, 
at its sole discretion, address issues and bugs reported in this manner, and 
responses are not guaranteed.</P>
<P>The SOFTWARE (including instructions for its use and all printed and online 
documentation) is provided AS IS without warranty of any kind. Microsoft further 
disclaims all implied warranties including, without limitation, any implied 
warranties of merchantability or of fitness for a particular purpose. The entire 
risk arising out of the use or performance of the SOFTWARE and documentation 
remains with you.</P>
<P>In no event shall Microsoft, its authors, or anyone else involved in the 
creation, production, or delivery of the SOFTWARE be liable for any damages 
whatsoever (including, without limitation, damages for loss of business profits, 
business interruption, loss of business information, or other pecuniary loss) 
arising out of the use of or inability to use the SOFTWARE or documentation, 
even if Microsoft has been advised of the possibility of such damages.</P>
<P>© Copyright 1985&#8211;2001 Microsoft Corporation. All rights 
reserved.</P></LI></BODY></HTML>
